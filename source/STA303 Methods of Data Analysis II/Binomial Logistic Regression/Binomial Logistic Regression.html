<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Binomial Logistic Regression - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/index/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">Binomial Logistic Regression</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="$Y\sim-Binomial(m,-\pi)$">$Y\sim Binomial(m, \pi)$<a class="anchor-link" href="#$Y\sim-Binomial(m,-\pi)$">&#182;</a></h4><p>$P(Y=y)={m\choose y} \pi^y (1-\pi)^{m-y}$
v.s. Bernoulli =&gt; $\pi$ remains the same in binomial, while in Bernoulli case it is independent for each $X_i$</p>
<p>$E(Y)=m\pi$, $var(Y)=m\pi(1-\pi)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider modelling $Y.m$ be the proportion of success out of $m$ independent Bernoulli trials 
$E(Y/m)=\pi, var(Y/m)=\pi(1-\pi)/m$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">Sleuth3</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="n">krunnit</span> <span class="o">=</span> <span class="n">case2101</span>

<span class="n">Extinct</span> <span class="o">=</span> <span class="n">krunnit</span><span class="o">$</span><span class="n">Extinct</span> <span class="c1"># number of &quot;success&quot;</span>
<span class="n">AtRisk</span> <span class="o">=</span> <span class="n">krunnit</span><span class="o">$</span><span class="n">AtRisk</span>
<span class="n">Area</span> <span class="o">=</span> <span class="n">krunnit</span><span class="o">$</span><span class="n">Area</span>

<span class="n">pis</span> <span class="o">=</span> <span class="n">Extinct</span><span class="o">/</span><span class="n">AtRisk</span>
<span class="n">NExtinct</span> <span class="o">=</span> <span class="n">AtRisk</span> <span class="o">-</span> <span class="n">Extinct</span> <span class="c1"># number of &quot;failure&quot;</span>
<span class="n">logitpi</span> <span class="o">=</span> <span class="nf">log</span><span class="p">(</span><span class="n">pis</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="p">(</span><span class="n">pis</span><span class="p">)))</span>
<span class="n">logarea</span> <span class="o">=</span> <span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">)</span>
<span class="n">case2101</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th scope=col>Island</th><th scope=col>Area</th><th scope=col>AtRisk</th><th scope=col>Extinct</th></tr></thead>
<tbody>
	<tr><td>Ulkokrunni     </td><td>185.80         </td><td>75             </td><td> 5             </td></tr>
	<tr><td>Maakrunni      </td><td>105.80         </td><td>67             </td><td> 3             </td></tr>
	<tr><td>Ristikari      </td><td> 30.70         </td><td>66             </td><td>10             </td></tr>
	<tr><td>Isonkivenletto </td><td>  8.50         </td><td>51             </td><td> 6             </td></tr>
	<tr><td>Hietakraasukka </td><td>  4.80         </td><td>28             </td><td> 3             </td></tr>
	<tr><td>Kraasukka      </td><td>  4.50         </td><td>20             </td><td> 4             </td></tr>
	<tr><td>Lansiletto     </td><td>  4.30         </td><td>43             </td><td> 8             </td></tr>
	<tr><td>Pihlajakari    </td><td>  3.60         </td><td>31             </td><td> 3             </td></tr>
	<tr><td>Tyni           </td><td>  2.60         </td><td>28             </td><td> 5             </td></tr>
	<tr><td>Tasasenletto   </td><td>  1.70         </td><td>32             </td><td> 6             </td></tr>
	<tr><td>Raiska         </td><td>  1.20         </td><td>30             </td><td> 8             </td></tr>
	<tr><td>Pohjanletto    </td><td>  0.70         </td><td>20             </td><td> 2             </td></tr>
	<tr><td>Toro           </td><td>  0.70         </td><td>31             </td><td> 9             </td></tr>
	<tr><td>Luusiletto     </td><td>  0.60         </td><td>16             </td><td> 5             </td></tr>
	<tr><td>Vatunginletto  </td><td>  0.40         </td><td>15             </td><td> 7             </td></tr>
	<tr><td>Vatunginnokka  </td><td>  0.30         </td><td>33             </td><td> 8             </td></tr>
	<tr><td>Tiirakari      </td><td>  0.20         </td><td>40             </td><td>13             </td></tr>
	<tr><td>Ristikarenletto</td><td>  0.07         </td><td> 6             </td><td> 3             </td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let $\pi_i$ be the probability of extinction for each island, assume that this is the same for each species for bird on a particular island</p>
<p>Assume species survival is independent.<br>
Then $Y_i\sim Binomial(m_i,\pi_i)$</p>
<p>Unlike binary logistic model for Bernoulli distribution, we can estimate $\pi_i$ from the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Observed response proportion $\bar{\pi_i} = y_i/m_i$</p>
<p>Observed or empirical logits: (S-"saturated)
$$\log(\frac{\bar{\pi}_{S,i}}{1 - \bar{\pi}_{S,i}}) = \log(\frac{y_i}{m_i-y_i})$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">krunnit</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Area</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">logitpi</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAANlBMVEUAAAAzMzNNTU1oaGh8
fHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD////agy6EAAAACXBIWXMA
ABJ0AAASdAHeZh94AAAeKUlEQVR4nO2dAVfTVx4Fn4FiW62S7/9lSwC5oEQTee9/nTC/c9Z2
u+uc4cIsJEJ27D3Pe/ONtoDnXcIZkudNOEPyvAlnSJ434QzJ8yacIXnehDMkz5twhuR5E+63
Qvr66zvlv/OGY+Ph+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13ed
sAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7v
OmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc
33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4
uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05Y54a0uztDovDZeJL+uSHtnn45
MaQxxkTdV96ApXQ/VJp4kv7qkMZYXBJo6wKfjSfpLw5pjNUlgbYu8Nl4kv7vh/ThcL/6rz+G
dBLa8y7h/IxUwMP1XSestSH5GKnLZ+NJ+qtD8lm7Kp+NJ+kvD4k0xvZ4uL7rhGVITTxc33XC
OjMkv7MBxWfjSfpnh/TyNra9ODxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/Vd
JyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfr
u05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP
13edsAypiYfru05YhtTEw/VdJ6zlIflKq0U+G0/SXx6Sr/3d5LPxJP3VIS1/FX3Q1gU+G0/S
N6QqHq7vOmEZUhMP13edsBaH5GOkKp+NJ+kvD8ln7Zp8Np6kvz4k0Bjb4+H6rhOWITXxcH3X
CcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6
rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD
9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJ
h+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlS
Ew/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIy
pCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuE
ZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3X
CcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6
rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD
9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJ
h+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlS
Ew/Xd52wDKmJh+u7TliG1MTD9V0nrLeF5Hney/MzUgEP13edsAypiYfru05YhtTEw/VdJyxD
auLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05Y
htTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13ed
sAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7v
OmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc
33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4
uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE1
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
Ew/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIy
pCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuE
ZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6rhOWITXxcH3X
CcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD9V0nLENq4uH6
rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJh+u7TliG1MTD
9V0nLENq4uH6rhOWITXxcH3XCcuQmni4vuuEZUhNPFzfdcIypCYeru86YRlSEw/Xd52wDKmJ
h+u7TlhvC8nzvJfnZ6QCHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE1
8XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxD
auLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05Y
htTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13ed
sAypiYfru05YhtTEw/VdJyxDauLh+u9knTHGr1mG1MTD9d/HOmOcUJIhVfFw/XexzhinlGRI
VTxc/12sY0gAPFz/XaxjSAA8XP99rONjpD8fD9d/J+v4rN0fj4fru05YhtTEw/VdJyxDauLh
+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTE
w/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAyp
iYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZ
UhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XC
MqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7r
hGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB9
1wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTEw/VdJyxDauLh
+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAypiYfru05YhtTE
w/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZUhMP13edsAyp
iYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJp4uL7rhGVITTxc33XCMqQmHq7vOmEZ
UhMP13edsAypiYfru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnr3JB2d2dIFD4bT9I/N6Td
0y+GBOCz8SR9Q6ri4fquE9aZIaUmQwLw2XiS/u+H9OFwp/8ez3sfd2pIPtkA4rPxJP3zQ9r7
pR2Hz8aT9E8P6dnz3oZE4bPxJP1zPyP5rB2Kz8aT9A2piofru05YZ4bkdzag+Gw8Sf/skF7e
xrYXh4fru05YhtTEw/VdJyxDauLh+q4TliE18XB91wnLkJr4iv4YYyV+4oHeuYZUxTf0x5hW
0gWu89ssQ2riC/pjzCvp8tb5fZYhNfGG1OQb0sXgDanJN6SLwfsYqck3pIvB+6xdk29IF4OH
67tOWIbUxMP1XScsQ2ri4fquE5YhNfFwfdcJy5CaeLi+64RlSE08XN91wjKkJh6u7zphGVIT
D9d3nbAMqYmH67tOWIbUxMP1XScsQ2ri4fquE5YhNfFwfdcJy5CaeLi+64RlSE08XN91wjKk
Jh6u7zphGVITD9d3nbAMqYmH67tOWIbUxMP1XScsQ2ri4fquE5YhNfFwfdcJy5CaeLi+64Rl
SE08XN91wjKkJh6u7zphGVITD9d3nbAMqYmH67tOWIbUxMP1XScsQ2ri4fquE5YhNfFwfdcJ
y5CaeLi+64RlSE08XN91wjKkJh6u7zphvS2kE+7DIu42x7ZXv3CG9Nqx7dUvnCG9dmx79Qtn
SK8d2179wq0KyfPe1RmS5004Q/K8CWdInjfhDMnzJpwhed6EWxPS7u6WgJff7lEd+RY8GH9T
x70J0Qe+B5aEtHv6BXe7Z3+hvQW7WO+Ab8JjN9D3gCG9POi78XC7PTqk3d6Qvj/aCLnd87/i
3gJ0SN8Z0/QN6cU9fYG+3wPfgosICfoeMKQXx/0oPNxFhPT4C03fkH484Lvx4dAfic9lgfqG
9OMB340PZ0i9M6QXx/0oPNwlhETVN6QXt3v2L95bgP5IfGZMfA/4nQ0vD/ttAYd7/IMY6puA
1vd77TxvwhmS5004Q/K8CWdInjfhDMnzJpwhed6EMyTPm3CG5HkTzpA8b8IZEubG8J31557v
G8p9ugvpU1vCO3aGRLmb8de4aUt4x86QKDfG7cPXdmP8t7ve729vxri5PfyDz3+NsfvYtXv3
Z0iQ+3T36ejm/mu7Ma4Pn5p2d1/qjav9w9d8d2dJ1TMkyB0i+nT/td1DM38ffv04/tnvr8a/
+/1/PhPRPeeH3H0oj7982R/yuf+nfx1+/fLp72tD6p7zM+7x67fD13bfHik93N3fXj/9nVc7
52fczWM3Nz+GdDOu/vn0xZC65/yM243DE3S3Y/ctpKun99z9v781pO45P+I+P/4R0s34/BjS
x8OTDf+O60NIn/e3PkYqn/Mj7uNdLIf7dJfPQzK3909/j/8O/5mPkfrn/Ih7ekGdu795TObL
3cOm6/u87v/GkLrn/J434QzJ8yacIXnehDMkz5twhuR5E86QPG/CGZLnTThD8rwJZ0ieN+EM
yfMmnCF53oQzJM+bcP8DXsOl8vdUlX0AAAAASUVORK5CYII="
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">krunnit</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">logitpi</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then the proposed model is based on plot
$$\log(\frac{\pi_i}{1-\pi_i})=\beta_0 + \beta_1 \log(Area_i)$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># cbind(Extinct, NExtinct ~ log(Area) is the way to represent it in R</span>
<span class="n">fitbl</span> <span class="o">&lt;-</span> <span class="nf">glm</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">Extinct</span><span class="p">,</span> <span class="n">NExtinct</span><span class="p">)</span><span class="o">~</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">krunnit</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fitbl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = cbind(Extinct, NExtinct) ~ log(Area), family = binomial, 
    data = krunnit)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.71726  -0.67722   0.09726   0.48365   1.49545  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.19620    0.11845 -10.099  &lt; 2e-16 ***
log(Area)   -0.29710    0.05485  -5.416 6.08e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 45.338  on 17  degrees of freedom
Residual deviance: 12.062  on 16  degrees of freedom
AIC: 75.394

Number of Fisher Scoring iterations: 4
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">anova</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s">&quot;Chisq&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>Df</th><th scope=col>Deviance</th><th scope=col>Resid. Df</th><th scope=col>Resid. Dev</th><th scope=col>Pr(&gt;Chi)</th></tr></thead>
<tbody>
	<tr><th scope=row>NULL</th><td>NA          </td><td>      NA    </td><td>17          </td><td>45.33802    </td><td>          NA</td></tr>
	<tr><th scope=row>log(Area)</th><td> 1          </td><td>33.27651    </td><td>16          </td><td>12.06151    </td><td>7.994246e-09</td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">vcov</span><span class="p">(</span><span class="n">fitbl</span><span class="p">)</span> <span class="c1"># variance co-variance matrix</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>(Intercept)</th><th scope=col>log(Area)</th></tr></thead>
<tbody>
	<tr><th scope=row>(Intercept)</th><td> 0.014029452</td><td>-0.002602237</td></tr>
	<tr><th scope=row>log(Area)</th><td>-0.002602237</td><td> 0.003008830</td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># 95% CI for beta</span>
<span class="n">CL</span> <span class="o">=</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">bhat</span><span class="o">=</span><span class="nf">coef</span><span class="p">(</span><span class="n">fitbl</span><span class="p">),</span> <span class="nf">confint.default</span><span class="p">(</span><span class="n">fitbl</span><span class="p">))</span>
<span class="n">CL</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>bhat</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr></thead>
<tbody>
	<tr><th scope=row>(Intercept)</th><td>-1.1961955</td><td>-1.4283454</td><td>-0.9640456</td></tr>
	<tr><th scope=row>log(Area)</th><td>-0.2971037</td><td>-0.4046132</td><td>-0.1895942</td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Model-summary">Model summary<a class="anchor-link" href="#Model-summary">&#182;</a></h4><h1 id="observations:-18">observations: 18<a class="anchor-link" href="#observations:-18">&#182;</a></h1><h1 id="coefficients:-2">coefficients: 2<a class="anchor-link" href="#coefficients:-2">&#182;</a></h1><p>fitted model $logit(\hat\pi) = -1.196-0.297\log(Area)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wald procedures still work the same</p>
<p>$H_0:\beta_1=0$<br>
$z=\frac{\hat\beta_1}{se(\hat\beta_1)}\sim N(0,1)$<br>
CI: $\hat\beta_1\pm t_{\alpha,1}se(\hat\beta_1)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interpretation-of-$\beta_1$">Interpretation of $\beta_1$<a class="anchor-link" href="#Interpretation-of-$\beta_1$">&#182;</a></h2><p>Model: 
$$logit(\pi) = \beta_0 + \beta_1\log(x)\Rightarrow\\
\\frac{pi}{1-\pi} = e^{\beta_0}e^{\beta_1\log(x)} = e^{\beta_0}x^{\beta_1}$$
CHanging $x$ by a factor of $h$ will change the odds by a multiplicative factor of $h^{\beta_1}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example:
Halving island area changes odds by a factor of $0.5^{-0.2971} = 1.23$</p>
<p>Therefore, the odds of extinction on a smaller island are 123% of the odds of extinction on an island double its size.</p>
<p>Halving of area is associated with an increase in the odds of extinction by an estimated 23%. An approximate 95% confidence interval for the percentage change in odds is 14%-32%</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># CI of beta&#39;s for halfing area</span>
<span class="m">0.5</span><span class="nf">^</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>bhat</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr></thead>
<tbody>
	<tr><th scope=row>(Intercept)</th><td>2.291346</td><td>2.691379</td><td>1.950773</td></tr>
	<tr><th scope=row>log(Area)</th><td>1.228675</td><td>1.323734</td><td>1.140443</td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="n">phats</span> <span class="o">=</span> <span class="nf">predict.glm</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;response&quot;</span><span class="p">)</span>
<span class="nf">options</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="nf">rbind</span><span class="p">(</span><span class="n">Extinct</span><span class="p">,</span> <span class="n">NExtinct</span><span class="p">,</span> <span class="n">pis</span><span class="p">,</span> <span class="n">phats</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>1</th><th scope=col>2</th><th scope=col>3</th><th scope=col>4</th><th scope=col>5</th><th scope=col>6</th><th scope=col>7</th><th scope=col>8</th><th scope=col>9</th><th scope=col>10</th><th scope=col>11</th><th scope=col>12</th><th scope=col>13</th><th scope=col>14</th><th scope=col>15</th><th scope=col>16</th><th scope=col>17</th><th scope=col>18</th></tr></thead>
<tbody>
	<tr><th scope=row>Extinct</th><td> 5.00000</td><td> 3.00000</td><td>10.00000</td><td> 6.0000 </td><td> 3.0000 </td><td> 4.000  </td><td> 8.0000 </td><td> 3.00000</td><td> 5.0000 </td><td> 6.0000 </td><td> 8.0000 </td><td> 2.0000 </td><td> 9.0000 </td><td> 5.0000 </td><td>7.0000  </td><td> 8.0000 </td><td>13.0000 </td><td>3.0000  </td></tr>
	<tr><th scope=row>NExtinct</th><td>70.00000</td><td>64.00000</td><td>56.00000</td><td>45.0000 </td><td>25.0000 </td><td>16.000  </td><td>35.0000 </td><td>28.00000</td><td>23.0000 </td><td>26.0000 </td><td>22.0000 </td><td>18.0000 </td><td>22.0000 </td><td>11.0000 </td><td>8.0000  </td><td>25.0000 </td><td>27.0000 </td><td>3.0000  </td></tr>
	<tr><th scope=row>pis</th><td> 0.06667</td><td> 0.04478</td><td> 0.15152</td><td> 0.1176 </td><td> 0.1071 </td><td> 0.200  </td><td> 0.1860 </td><td> 0.09677</td><td> 0.1786 </td><td> 0.1875 </td><td> 0.2667 </td><td> 0.1000 </td><td> 0.2903 </td><td> 0.3125 </td><td>0.4667  </td><td> 0.2424 </td><td> 0.3250 </td><td>0.5000  </td></tr>
	<tr><th scope=row>phats</th><td> 0.06017</td><td> 0.07036</td><td> 0.09854</td><td> 0.1380 </td><td> 0.1595 </td><td> 0.162  </td><td> 0.1639 </td><td> 0.17125</td><td> 0.1854 </td><td> 0.2052 </td><td> 0.2226 </td><td> 0.2516 </td><td> 0.2516 </td><td> 0.2603 </td><td>0.2842  </td><td> 0.3019 </td><td> 0.3278 </td><td>0.3998  </td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Question: estimate the probability of extinction for a species on the Ulkokrunni island (Area $= 185.5 km^2$)</p>
<p>$logit(\hat\pi_{M,1}=)-1.196 - 0.297\log(185.5) = -2.75$</p>
<p>$\hat\pi_{M,1} = 0.06$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="n">logit_result</span> <span class="o">=</span> <span class="m">-1.196</span> <span class="o">-</span> <span class="m">0.297</span> <span class="o">*</span> <span class="nf">log</span><span class="p">(</span><span class="m">185.5</span><span class="p">)</span>
<span class="n">pi_m1</span> <span class="o">=</span> <span class="nf">exp</span><span class="p">(</span><span class="n">logit_result</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="m">1</span><span class="o">+</span> <span class="nf">exp</span><span class="p">(</span><span class="n">logit_result</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">logit_result</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">pi_m1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] -2.747
[1] 0.06024
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Diagnostics">Diagnostics<a class="anchor-link" href="#Diagnostics">&#182;</a></h2><p>Model assumptions</p>
<ul>
<li>Underlying probability model is Binomial  variance non constant, is a function of the mean</li>
<li>Observation independent</li>
<li>The form of the model is correct  <ul>
<li>Liner relationship between logits and explanatory variables</li>
<li>All relevant variables are included, irrelevant ones excluded</li>
</ul>
</li>
<li>Sample size is large enough for valid inferences<ul>
<li>outliers</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Saturated-Model">Saturated Model<a class="anchor-link" href="#Saturated-Model">&#182;</a></h4><p>Model that fits exactly with the data<br>
Most general model possible for the data</p>
<p>Consider one explanatory variable, X with $n$ unique levels for the outcome, $Y\sim Binomial(m,\pi)$</p>
<p><strong>Saturated Model</strong> as many parameter coefficients as $n$</p>
<p><strong>Fitted Model</strong>  nested within a FULL model, has (p+1) parameters</p>
<p><strong>Null Model</strong>L intercept only</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Checking-model-adequacy:-Form-of-the-model---Deviance-Goodness-of-Fit-Test">Checking model adequacy: Form of the model - Deviance Goodness of Fit Test<a class="anchor-link" href="#Checking-model-adequacy:-Form-of-the-model---Deviance-Goodness-of-Fit-Test">&#182;</a></h4><p>Form of Hypothesis: $H_0: $ reduced model, $H_a: $ Full model</p>
<p>Deviance GOF test compares the fitted model $M$ to the saturated model $S$</p>
<p>Test Statistic: $$Deviance = -2\log(\mathcal{L}_R/\mathcal{L}_F)\sim \chi^2_{n-p-1}$$
This is an asymptotic approximation, so it works better if each $m_i&gt;5$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fitbl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = cbind(Extinct, NExtinct) ~ log(Area), family = binomial, 
    data = krunnit)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7173  -0.6772   0.0973   0.4837   1.4954  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.1962     0.1184  -10.10  &lt; 2e-16 ***
log(Area)    -0.2971     0.0549   -5.42  6.1e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 45.338  on 17  degrees of freedom
Residual deviance: 12.062  on 16  degrees of freedom
AIC: 75.39

Number of Fisher Scoring iterations: 4
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Example</strong> Deviance GOF with R-output
$H_0:$ Fitted model $logit(\pi)~\log(Area)$<br>
$H_a: $ Saturated model</p>
<p>Test statistic: $Deviance = 12.062$ (Residual deviance)</p>
<p>Distribution: $Deviance\sim \chi^2_{18-2}$</p>
<p>p-value: $P(\chi^2_{16}\leq 12.062) = 0.74$</p>
<p>Conclusion: the data are consistent with $H_0$; the simpler model with linear function of log(Area) is adequate (fit as well as the saturated model)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># calculate p-value for example</span>
<span class="m">1</span> <span class="o">-</span> <span class="nf">pchisq</span><span class="p">(</span><span class="m">12.062</span><span class="p">,</span> <span class="m">16</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.739700862578766
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Small deviance leads to larger p-value and vice versa.</p>
<p>Large p-value means:</p>
<ul>
<li>fitted model is adequate</li>
<li>Test is not powerful enough to detect inadequacies</li>
</ul>
<p>Small p-value means:</p>
<ul>
<li>fitted model is not adequate, consider a more complex model with more explanatory variables or higher order terms and so on OR</li>
<li>response distribution is not adequately modeled by the Binomial distribution, OR</li>
<li>There are severe outliers</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Outliers">Outliers<a class="anchor-link" href="#Outliers">&#182;</a></h4><p><strong>Response (raw) residuals</strong>
$$\hat\pi_{S,i}-\hat\pi_{M,i}=y_i/M_i-\hat\pi_{M,i}$$
<strong>Standardized residuals</strong></p>
<ul>
<li>Pearson Residuals: uses estimate of s.d. of $Y$ $$P_{res,i}=\frac{y_i-m_i\hat\pi_{M,i}}{\sqrt{m_i\hat\pi_{M,i}(1-\hat\pi_{M,i})}}$$</li>
<li>Deviance Residuals: defined so that the sum of the square of the residuals is the deviance
$$D_{res,i}=sign(y_i-m_i\hat\pi_{&lt;i})\sqrt{2(y_i\log(\frac{y_i}{m_i\hat\pi_{M,i}})+(m_i-y_i)\log(\frac{m_i-y_i}{m_i-m_i\pi\hat\pi_{M,i}}))}$$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># response residuals</span>
<span class="n">rres</span> <span class="o">=</span> <span class="nf">residuals</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;response&quot;</span><span class="p">)</span>
<span class="c1"># pearson residuals</span>
<span class="n">pres</span> <span class="o">=</span> <span class="nf">residuals</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;pearson&quot;</span><span class="p">)</span>
<span class="c1"># Deviance residuals</span>
<span class="n">dres</span> <span class="o">=</span> <span class="nf">residuals</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;deviance&quot;</span><span class="p">)</span>
<span class="nf">cbind</span><span class="p">(</span><span class="n">pis</span><span class="p">,</span> <span class="n">phats</span><span class="p">,</span> <span class="n">rres</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">dres</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th scope=col>pis</th><th scope=col>phats</th><th scope=col>rres</th><th scope=col>pres</th><th scope=col>dres</th></tr></thead>
<tbody>
	<tr><td>0.06667  </td><td>0.06017  </td><td> 0.006493</td><td> 0.23646 </td><td> 0.23266 </td></tr>
	<tr><td>0.04478  </td><td>0.07036  </td><td>-0.025585</td><td>-0.81883 </td><td>-0.87369 </td></tr>
	<tr><td>0.15152  </td><td>0.09854  </td><td> 0.052975</td><td> 1.44400 </td><td> 1.34958 </td></tr>
	<tr><td>0.11765  </td><td>0.13800  </td><td>-0.020351</td><td>-0.42139 </td><td>-0.43071 </td></tr>
	<tr><td>0.10714  </td><td>0.15946  </td><td>-0.052319</td><td>-0.75619 </td><td>-0.79584 </td></tr>
	<tr><td>0.20000  </td><td>0.16205  </td><td> 0.037951</td><td> 0.46058 </td><td> 0.44746 </td></tr>
	<tr><td>0.18605  </td><td>0.16389  </td><td> 0.022155</td><td> 0.39247 </td><td> 0.38577 </td></tr>
	<tr><td>0.09677  </td><td>0.17125  </td><td>-0.074480</td><td>-1.10075 </td><td>-1.18097 </td></tr>
	<tr><td>0.17857  </td><td>0.18542  </td><td>-0.006844</td><td>-0.09318 </td><td>-0.09363 </td></tr>
	<tr><td>0.18750  </td><td>0.20524  </td><td>-0.017742</td><td>-0.24850 </td><td>-0.25127 </td></tr>
	<tr><td>0.26667  </td><td>0.22264  </td><td> 0.044030</td><td> 0.57969 </td><td> 0.56727 </td></tr>
	<tr><td>0.10000  </td><td>0.25158  </td><td>-0.151576</td><td>-1.56220 </td><td>-1.71726 </td></tr>
	<tr><td>0.29032  </td><td>0.25158  </td><td> 0.038747</td><td> 0.49717 </td><td> 0.48934 </td></tr>
	<tr><td>0.31250  </td><td>0.26030  </td><td> 0.052203</td><td> 0.47588 </td><td> 0.46659 </td></tr>
	<tr><td>0.46667  </td><td>0.28415  </td><td> 0.182515</td><td> 1.56733 </td><td> 1.49545 </td></tr>
	<tr><td>0.24242  </td><td>0.30185  </td><td>-0.059429</td><td>-0.74367 </td><td>-0.75939 </td></tr>
	<tr><td>0.32500  </td><td>0.32783  </td><td>-0.002828</td><td>-0.03810 </td><td>-0.03813 </td></tr>
	<tr><td>0.50000  </td><td>0.39984  </td><td> 0.100157</td><td> 0.50082 </td><td> 0.49570 </td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">rres</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">pres</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">dres</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
PA0o/1MAAAAASUVORK5CYII="
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pearson vs Deviance Residuals</strong></p>
<ul>
<li>Both asymptotically to $N(0,1)$</li>
<li>Possible outlier if $|res|&gt;2$</li>
<li>Definite outlier if $|res|&gt;3$</li>
<li>Under small $n$ $D_{res}$ closer to $N(0,1)$ then $P_{res}$</li>
<li>When $\hat\pi$ close to extreme (0, 1), $P_{res}$ are unstable</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Problems-and-Solutions">Problems and Solutions<a class="anchor-link" href="#Problems-and-Solutions">&#182;</a></h2><p><strong>Issues Related to General Linear Models</strong></p>
<p>extrapolation</p>
<ul>
<li>Don't make inferences/predictions outside range of observed data</li>
<li>Model may no longer be appropriate</li>
</ul>
<p>Multicollinearity<br>
Consequences includes</p>
<ul>
<li>unstable fitted equation</li>
<li>Coefficient that should be statistically significant while not</li>
<li>Coefficient may have wrong sign</li>
<li>Sometimes large $se(\beta)$</li>
<li>Sometimes numerical procedure to find MLEs does not converge</li>
</ul>
<p>Influential Points</p>
<p>Model: overfit issue, should build model on training data (cross validation)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Problems specific to Logistic Regression</strong></p>
<p>Extra-binomial variation (over dispersion)</p>
<ul>
<li>variance of $Y_i$ greater than $m_i\pi_i(1-\pi_i)$</li>
<li>Does not bias $\hat\beta$'s but se of $\hat\beta$'s will be too small </li>
</ul>
<p>Solution: add one more parameter to the model, $\phi$-dispersion parameter. Then $var(Y_i)=\phi m_i\pi_i(1-\pi_i)$</p>
<p>Complete separation</p>
<ul>
<li>One or a linear combination of explanatory variables perfectly predict whether $Y=1\lor 0$</li>
<li>In Binary response, when $y_i=1,\hat y_i=1$, then $\sum_{i=1}^n\{y_i\log(\hat y_i + (1-y_i)\log(1-\hat y_i))=0\}$</li>
<li>MLE cannot be computed</li>
</ul>
<p>Quasi-complete separation:</p>
<ul>
<li>explanatory variables predict $Y=1\lor 0$ almost perfectly</li>
<li>MLE are numerically unstable</li>
</ul>
<p>Solution: simplify the model. Try other methods like penalized maximum likelihood, exact logistic regression, Bayesian methods</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Conclusions-about-Logistic-Regression">Conclusions about Logistic Regression<a class="anchor-link" href="#Conclusions-about-Logistic-Regression">&#182;</a></h4><p><strong>False</strong> Logistic regression describes population proportion of probability as a linear function of explanatory variables.</p>
<p>Non-linear $\hat\pi = e^{\hat\mu}/(1+e^{\hat\mu})$</p>
<p>Hence Logistic regression is a nonlinear regression model</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Extra-binomial-variation">Extra-binomial variation<a class="anchor-link" href="#Extra-binomial-variation">&#182;</a></h4><p>Suppose $X_1,...,X_m$ are not independent but identically distributed $\sim Bernoulli(\pi)$. Further suppose $\forall X_i,X_j. cov(X_1,X_j)=\rho, \rho&gt;0$.</p>
<p>Let $Y_1=\sum_i^{m_1}X_i$</p>
<p>Then</p>
$$var(Y_i)= \sum_i^{m_1}var(X_i) + \sum_{i\neq j} cov(X_i,X_j)\\
= m_1\pi(1-\pi)+\sum_{i\neq j} \rho\sqrt{var(X_i)var(X_j)}\\ 
=m_1\pi(1-\pi) + m_1(m_1-1)\rho\pi(1-\pi)\\
&gt;m_1\pi(1-\pi)$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore, the model for variance:
$$var(Y_i)=\psi m_i\pi_i(1-\pi_i)$$
estimate of $\hat\psi$ by scaled Pearson chi-square statistic
$$\hat\psi = \sum_i^n \frac{P^2_{res,i}}{n-(p+1)}=\frac{\text{sum of squared Pearson residuals}}{d.f.}$$</p>
<p>$\hat\psi&gt;&gt;1$ indicates evidence of over-dispersion</p>
<p>$\psi$ does not effect $E(Y_i)$, hence using over-dispersion does not change $\hat\beta$</p>
<p>The standard errors under this assumption is $se_{\psi}(\hat\beta)=\sqrt{\hat\psi}se(\hat\beta)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following two ways are equivalent</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># manually conpute the psi hat</span>
<span class="n">psihat</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">residuals</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;pearson&quot;</span><span class="p">)</span><span class="n">^2</span><span class="o">/</span><span class="n">fitbl</span><span class="o">$</span><span class="n">df.residual</span><span class="p">)</span>
<span class="n">psihat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.73257293737338
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># apply the dispersion</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fitbl</span><span class="p">,</span> <span class="n">dispersion</span><span class="o">=</span><span class="n">psihat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = cbind(Extinct, NExtinct) ~ log(Area), family = binomial, 
    data = krunnit)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7173  -0.6772   0.0973   0.4837   1.4954  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -1.1962     0.1014  -11.80  &lt; 2e-16 ***
log(Area)    -0.2971     0.0469   -6.33  2.5e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 0.7326)

    Null deviance: 45.338  on 17  degrees of freedom
Residual deviance: 12.062  on 16  degrees of freedom
AIC: 75.39

Number of Fisher Scoring iterations: 4
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># use quasi binomial family</span>
<span class="n">fitbl2</span> <span class="o">&lt;-</span> <span class="nf">glm</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">Extinct</span><span class="p">,</span> <span class="n">NExtinct</span><span class="p">)</span><span class="o">~</span><span class="nf">log</span><span class="p">(</span><span class="n">Area</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="n">quasibinomial</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">krunnit</span><span class="p">)</span>
<span class="n">fitbl2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:  glm(formula = cbind(Extinct, NExtinct) ~ log(Area), family = quasibinomial, 
    data = krunnit)

Coefficients:
(Intercept)    log(Area)  
     -1.196       -0.297  

Degrees of Freedom: 17 Total (i.e. Null);  16 Residual
Null Deviance:	    45.3 
Residual Deviance: 12.1 	AIC: NA</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Using-Logistic-Regression-for-Classification">Using Logistic Regression for Classification<a class="anchor-link" href="#Using-Logistic-Regression-for-Classification">&#182;</a></h4><p>Want: $y^*\mid (x_1^*, ...,x_p^*)= \mathbb
{I}$</p>
<p>Do: calculate $\hat\pi_M^*$ be the estimated probability that $y^*=1$ based on the fitted model given $X_i=x_i^*$, then predict that $y^* = \mathbb{I}(\hat\pi_M^* \text{is large enough})$</p>
<p>Need: a good cutoff $\hat\pi_M^*$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Classification</strong></p>
<p>Try different cutoffs and see which gives fewest incorrect classifications</p>
<ul>
<li>Useful if proportion of 1's and 0's in date reflect their relative proportions in the population</li>
<li>Likely to overestimate. To overcome,cross-validation (training group vs. validation group)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Confusion Matrix</strong>
<a href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a></p>
<p>Choose a cutoff probability based on one of the 5 criteria for success of classification that is most important to you</p>
<p>Examples</p>
<ul>
<li>High sensitivity makes good screening test</li>
<li>High specificity makes a good confirmatory test</li>
<li>A screening test followed by a confirmatory test is good (but expensive) diagnostic procedure</li>
</ul>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
