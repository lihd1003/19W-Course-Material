<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>7-Constrainted Optimization on Calulus of Variations - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/index/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">7-Constrainted Optimization on Calulus of Variations</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Isoperimetric-Constraints">Isoperimetric Constraints<a class="anchor-link" href="#Isoperimetric-Constraints">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Thrm.-First-Order-Necessary-Conditions"><em>Thrm</em>. First Order Necessary Conditions<a class="anchor-link" href="#Thrm.-First-Order-Necessary-Conditions">&#182;</a></h2><p>Define functionals
\begin{align*}
F[u] := \int_a^b L^F(x, u(x), u'(x)) \, dx \\
G[u] L= \int_a^b L^G(x, u(x), u'(x)) \, dx.
\end{align*}
Our problem is of the form
\begin{align*}
\min_{u \in \mathcal{A}} \qquad &amp;F[u] \\
\text{subject to } &amp;G[u] = \mathrm{const} \\
\mathcal{A} &amp;= \{ u \in C^1([a, b], \mathbb R) : u(a) = A, u(b) = B \}.
\end{align*}</p>
<p>Suppose $u_*$ is a regular point of $G$ (i.e. $\frac{\delta G}{\delta u}(u_*) \neq 0$) which is a minimizer of $F$ subject to the equality constraint. Then there is a $\lambda \in \mathbb R$ such that
$$\frac{\delta F}{\delta u}(u_*) + \lambda \frac{\delta G}{\delta u}(u_*) = 0$$</p>
<p><em>The completed proof is too long, you can see a proof on one case in the Additional Examples</em></p>
<p>Recall that
$$\frac{\delta F}{\delta u}(u_*) = -\frac{d}{dx} L_p^F + L_z^F$$
and similarly for $\frac{\delta G}{\delta u}(u_*)$, so we can write the first order necessary conditions that we just described as 
$$-\frac{d}{dx} \left[ (L^F + \lambda L^G)_p \right] + \left( L^F + \lambda L^G \right)_z = 0$$
where it is understood at which point the partials of the Lagrangians are evaluated.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Holonomic-Constraints">Holonomic Constraints<a class="anchor-link" href="#Holonomic-Constraints">&#182;</a></h1><p>We consider a functional $F$ depending on three functions:
$$
F[\underbrace{x(\cdot), y(\cdot), z(\cdot)}_{u(\cdot)}] = \int_a^b L(t, \underbrace{x(t), y(t), z(t)}_{u(t)}, \underbrace{x'(t), y'(t), z'(t)}_{u'(t)}) \, dx,
$$
subject to a $C^1$constraint $H(x(t),y(t),z(t)) = 0$ for $t \in [a, b]$ with $\nabla H \neq 0$ on a space 
$$
\mathcal{A} = \{ u : [a, b] \to \mathbb R^3 : u \text{ is } C^1, u(a) = A, u(b) = B \}.
$$ 
(So the function "curves" lie on a surface in $\mathbb R^3$.) We would like to minimize $F[u(\cdot)]$ where $H(u(t)) = 0$ and $u \in \mathcal{A}$. The Euler-Lagrange equations in this case are
$$
\begin{pmatrix}
\frac{\delta F}{\delta x}(u)(t) \\
\frac{\delta F}{\delta y}(u)(t) \\
\frac{\delta F}{\delta z}(u)(t)
\end{pmatrix} + \lambda(t) \begin{pmatrix}
H_x(u(t)) \\
H_y(u(t)) \\
H_z(u(t))
\end{pmatrix} = \begin{pmatrix}
0 \\ 0 \\ 0
\end{pmatrix}.
$$
We may succinctly write this as
$$
\frac{\delta F}{\delta u} + \lambda (t) \nabla H = 0,
$$
which parallels nicely with the finite-dimensional case, if we consider variational problems to be infinite-dimensional problems.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example:-Motion-of-a-Spherical-Pendulum">Example: Motion of a Spherical Pendulum<a class="anchor-link" href="#Example:-Motion-of-a-Spherical-Pendulum">&#182;</a></h3><p>Consider again the example of the spherical pendulum. The Lagrangian function is
$$
L(t, x,y,z, \dot{x}, \dot{y}, \dot{z}) = \frac{1}{2} m (\dot{x}^2 + \dot{y}^2 + \dot{z}^2) - mgz.
$$
(Kinetic energy minus potential energy.) Thus the functional we wish to minimize is
$$
F[x(\cdot), y(\cdot), z(\cdot)] = \int_a^b L(t, x(t), y(t), \dot{x}(t), \dot{y}(t), \dot{z}(t)) \, dt,
$$
subject to the constraint that $(x(t), y(t), z(t))$ is on the sphere of radius $\ell$, i.e.
$$
H(x(t), y(t), z(t)) = \frac{1}{2}(x(t)^2 + y(t)^2 + z(t)^2) - \frac{1}{2} \ell^2 = 0.
$$
This is a holonomic constraints problem. Last week we solved this by parametrizing the sphere with spherical coordinates, freeing ourselves of the constraint. Now, we can use the first order necessary constraints to solve this.</p>
<p>Since the pendulum takes the path which minimizes the net difference in kinetic and potential energy, solutions to this problem will be the paths the pendulum takes depending on the initial conditions.</p>
<p>To match the notation we had before, we have
\begin{align*}
L(t, z_1,z_2,z_3, p_1,p_2,p_3) &amp;= \frac{1}{2} (p_1^2 + p_2^2 + p_3^2) - mgz_3 \\
H(x,y,z) &amp;= \frac{1}{2} (x^2+y^2+z^2) - \frac{1}{2} \ell^2.
\end{align*}
The partials we want are are
\begin{align*}
L_{p_1} &amp;= mp_1 &amp;L_{p_2} &amp;= mp_2 &amp;L_{p_3} &amp;= mp_3 \\
L_{z_1} &amp;= 0 &amp;L_{z_2} &amp;= 0 &amp;L_{z_3} &amp;= -mg \\
H_x &amp;= x &amp;H_y &amp;= y &amp;H_z &amp;= z
\end{align*}
We have
\begin{align*}
\frac{\delta F}{\delta x} = -m \ddot{x}(t) \quad\frac{\delta F}{\delta y} = -m \ddot{y}(t) \quad\frac{\delta F}{\delta y} = -m \ddot{z}(t) - mg.
\end{align*}
The Euler-Lagrange equations are
$$
\begin{pmatrix}
-m \ddot{x}(t) \\
-m \ddot{y}(t) \\
-m \ddot{z}(t) - mg
\end{pmatrix} + \lambda (t) \begin{pmatrix}
x(t) \\ y(t) \\ z(t)
\end{pmatrix} \equiv \begin{pmatrix}
0 \\ 0 \\ 0
\end{pmatrix}
$$
subject to the constraint $x(t)^2 + y(t)^2 + z(t)^2 = \ell^2$. There are four equations are four unknowns, so, in principle, the system may be solved.</p>
<p>We will solve this in the special case that $y \equiv 0$, $\ell = 1$, and $m = 1$. We lie in the $xy$-plane. We obtain
\begin{align*}
\ddot{x}(t) &amp;= \lambda(t)x(t) \\
\ddot{z}(t) &amp;= \lambda(t)z(t) - g \\
x(t)^2 + z(t)^2 &amp;= 1.
\end{align*}
Parametrize by $x(t) = \sin \theta(t)$ and $z(t) = -\cos \theta(t)$, so that
\begin{align*}
\dot{x} &amp;= \dot{\theta} \cos \theta \\
\dot{z} &amp;= \dot{\theta} \sin \theta
\end{align*}
and
\begin{align*}
\ddot{x} &amp;= \ddot{\theta} \cos \theta - \dot{\theta}^2 \sin \theta, \\
\ddot{z} &amp;= \ddot{\theta} \sin \theta + \dot{\theta}^2 \cos \theta.
\end{align*}
Plugging these into the Euler-Lagrange equations gives
\begin{align*}
\ddot{\theta} \cos \theta - \dot{\theta}^2 \sin \theta &amp;= \lambda \sin \theta \\
\ddot{\theta} \sin \theta + \dot{\theta}^2 \cos\theta &amp;= -\lambda \cos \theta - g.
\end{align*}
Multiplying the second equation by $\sin \theta$ gives, after a bit of simplifying,
$$
\ddot{\theta} \sin^2 \theta + \dot{\theta}^2 \sin \theta \cos \theta = -\ddot{\theta} \cos^2 \theta + \dot{\theta}^2 \sin \theta \cos \theta - g \sin \theta.
$$
This simplifies to
$$
\ddot{\theta} = -g \sin \theta,
$$
the equation of motion of a planar pendulum.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Sufficient-Conditions-and-Convexity">Sufficient Conditions and Convexity<a class="anchor-link" href="#Sufficient-Conditions-and-Convexity">&#182;</a></h1><p>Recall that if $u_* \in \mathcal{A} = \{ u \in C^1([a, b]) : u(a) = A, u(b) = B \}$ is a minimizer of the functional
$$F[u(\cdot)] := \int_a^b L(x, u(x), u'(x)) \, dx$$
Then it satisfies the "primitive" Euler-Lagrange equation
$$\int_a^b \Bigg[ L_z(x, u_*(x), u_*'(x))v(x) +  L_p(x, u_*(x), u_*'(x))v'(x) \Bigg] \, dx = 0$$
for all test functions $v$ on $[a, b]$.</p>
<p><strong>Lemma</strong> Assume the conditions above. Suppose $L = L(x,z,p)$ is a $C^1$ function, and that for each $x \in [a, b]$, $L(x, \cdot, \cdot)$ is convex. If $u_*$ satisfies (<em>) above, then $F[u_</em>(\cdot)] \leq F[u_*(\cdot) + v(\cdot)]$ for all test functions $v$ on $[a, b]$.</p>
<p><em>The lemma states, roughly, that if $u</em>*$ is a minimizer, then it must be a global minimizer._</p>
<p><em>proof</em>. Recall the $C^1$ criterion for convexity of a function $f : \mathbb R^n \to \mathbb R$: $f$ is convex if and only if $f(a + b) \geq f(a) + \nabla f(a) \cdot b$ for all $a,b \in \mathbb R^n$. We will apply this criterion to the convex function $L(x, \cdot, \cdot) : \mathbb R \times \mathbb R \to \mathbb R$. Directly applying the criterion gives
$$L(x, z + \tilde{z}, p + \tilde{p}) \geq L(x,z,p) + \underbrace{\nabla_{(z,p)}L(z,z,p) \begin{pmatrix}
\tilde{z} \\ \tilde{p}
\end{pmatrix}}_{=L_z(x,z,p)\tilde{z} + L_p(x,z,p)\tilde{p}}$$
Then
\begin{align*}
F[u_*(\cdot) + v(\cdot)] &amp;= \int_a^b L(x, u_*(x) + v(x), u_*'(x) + v'(x)) \, dx \\
&amp;\geq \int_a^b L(x, u_*(x), u_*'(x)) \, dx +  \underbrace{\int_a^b \Bigg[ L_z(\cdots)v(x) + L_p(\cdots)v'(x) \Bigg] \, dx}_{=0} \\
&amp;= \int_a^b L(x, u_*(x), u_*'(x)) \, dx \\
&amp;= L[u_*(\cdot)].
\end{align*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Thrm.-Convex-Domains"><em>Thrm</em>. Convex Domains<a class="anchor-link" href="#Thrm.-Convex-Domains">&#182;</a></h2><p>Recall that we were originally looking at convex functions $f : \Omega \to \mathbb R$, where $f$ is $C^1$ and convex and $\Omega \subseteq \mathbb R^n$ is convex. We had a theorem:</p>
<p><strong>Claim</strong>. Assume the above conditions. $x_*$ is a minimizer of $f$ on $\Omega$ if and only if $\nabla f(x_*)(x - x_*) \geq 0$ for all $x \in \Omega$.</p>
<p>Apply on variational</p>
<p>Consider a functional $$F[u(\cdot)] := \int_a^b L(x, u(x), u'(x)) \, dx$$
Let $\mathcal{A} = \{ u \in C^1([a, b]) : u(a) = A, u(b) = B \}$. Let $\Omega$ be a convex subset of $\mathcal{A}$, and suppose that $u_*$ is a minimizer of $F$ on $\Omega$. Then $F[u_*(\cdot) + sv(\cdot)] \geq F[u_*(\cdot)]$ for all $s$ and all test functions $v$ on $[a, b]$, and
$$\int_a^b \frac{\delta F}{\delta u}(u_*)(x)(u(x) - u_*(x))\, dx \int_a^b \frac{\delta F}{\delta u}(u_*)(x)v(x)\,dx = \left. \frac{d}{ds} \right|_{s=0} F[u_*(\cdot) + sv(\cdot)] \geq 0$$
for all $u \in \Omega$.</p>
<h3 id="Example">Example<a class="anchor-link" href="#Example">&#182;</a></h3><p>Suppose $F[u(\cdot)] = \int_0^1 \frac{1}{2} \left( u'(t)^2 + u(t) \right) \, dt$
where $\mathcal{A}$ is the set of $C^1$ functions on $[0, 1]$ that are zero at the endpoints, and $\Omega = \{ u \in \mathcal{A} : u(t) \geq \sin^2(\pi t) \}$. One can check that $\Omega$ is convex. The Lagrangian function is $L(x,z,p) = \frac{1}{2}(p^2 + z)$. This is a convex function of $(z,p)$, so it satisfies the conditions of the first lemma. Then if $u_*$ minimizes $F$ on $\Omega$, let $f(s) = F[(1 - s)u_*(\cdot) + su(\cdot)]$. We are asked to show that $f'(0) \geq 0$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Additional-Examples">Additional Examples<a class="anchor-link" href="#Additional-Examples">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-1-(Proof-of-equality-constraint-EL-Equation)">Example 1 (Proof of equality constraint EL Equation)<a class="anchor-link" href="#Example-1-(Proof-of-equality-constraint-EL-Equation)">&#182;</a></h2><p><em>Consider the problem</em>
\begin{align*}
\text{minimize}\quad &amp;I[x(\cdot)] = \frac12\int_0^\pi [x'(t)]^2 dt\\
\text{subject to} \quad &amp; J[x(\cdot)] = \int_0^\pi [x(t)]^2 dt = 1\\
\text{with conditions} \quad &amp;x\in \mathcal A :=\{x:[0,\pi]\rightarrow \mathbb R\mid x(0) = x(\pi) = 0\}
\end{align*}
<em>Suppose $x$ is a $C^2$ function that solve the problem, let $y\in \mathcal A$ be $C^2$, define</em>
$$a(s) = \bigg[\int_0^\pi(x(t) + sy(t))^2 dt\bigg]^{1/2}$$
$$i(s) = I[\frac{x(\cdot) + sy(\cdot))}{a(s)}]$$</p>
<p><em>(a) Show that $a(0) = 1, i'(0) = 0$</em></p>
<p><em>proof.</em><br>
$$a(0) = (\int_0^\pi (x(t) + 0y(t)^2)dt)^{1/2} = (\int_0^\pi x(t)^2dt)^{1/2}$$
Since $x$ solve the problem, it must follows the constraint $\int_0^\pi x(t) = 1$
$$a(0) = (\int_0^\pi x(t)^2dt)^{1/2} = 1$$
Since $x$ is the minimizer, FONC gives that $$\frac{d}{ds}\mid_{s=0}I[x(\cdot) + sy(\cdot)] = 0$$
for any test function $y\in\mathcal A$, note that 
$$\frac{d}{ds}\mid_{s=0}I[x(\cdot) + sy(\cdot)] = \frac{d}{ds}\mid_{s=0}I[\frac{x(\cdot) + sy(\cdot)}{1}] = i'(0) = 0$$</p>
<p><em>(b) Show that</em>
$$i'(0) = \int_0^\pi x'(t)y'(t)dt - \lambda \int_0^\pi x(t)y(t)dt$$
<em>for constant $\lambda$ in terms of $x(t)$</em></p>
<p><em>proof</em>. 
By multiplication rule
$$
i'(s) = -2a(s)^{-3}a'(s)I[x + sy] + a(s)^{-2}\frac{d}{ds}I[x+sy]$$
Evaluate at $s=0$ with $a(0) = 1$, we have
$$
i'(0) = -2a'(0)I[x(\cdot)] + \left.\frac{d}{ds}\right\vert_{s=0}I[x(\cdot) + sy(\cdot)]
$$
Then, note that 
\begin{align*}
a'(s) &amp;= \frac{1}{2}\bigg(\int_0^\pi(x(t) + sy(t))^2 dt\bigg)^{-1/2}\\&amp;\quad\frac{d}{ds}\int_0^\pi(x(t) + sy(t))^2dt\\
&amp;= \frac{1}{2}a(s)^{-1} 2\int_0^\pi (x(t) + sy(t))y(t)dt &amp;\text{Leibniz rule}\\
a'(0) &amp;= \int_0^\pi(x(t)+0y(t))y(t)dt \\
&amp;= \int_0^\pi x(t)y(t)dt\\
\frac{d}{ds}I[x + sy]&amp;= \frac{1}{2}\frac{d}{ds}\int_0^\pi(\frac d{dt} x(t)+sy(t))^2 dt\\
&amp;= \frac12\frac{d}{ds}\int_0^\pi (x'(t) + sy'(t))^2dt\\
&amp;= \frac12\int_0^\pi \frac{d}{ds}(x'(t) + sy'(t))^2dt&amp;\text{Leibniz rule}\\
&amp;= \int_0^\pi (x'(t)+sy'(t))y'(t)dt\\
\left.\frac{d}{ds}\right\vert_{s=0}I[x(\cdot) + sy(\cdot)]&amp;= \int_0^\pi(x'(t) + 0 y'(t))y'(t)dt \\
&amp;= \int_0^\pi x'(t)y'(t)dt\\
i'(0) &amp;= -2I[x(\cdot)]\int_0^\pi x(t)y(t)dt + \int_0^\pi x'(t)y'(t)dt
\end{align*}
so that let $\lambda = -2 I[x(\cdot)]$ we have 
$$i'(0) = \int_0^\pi x'(t)y'(t)dt -\lambda \int_0^\pi x(t)y(t)dt$$</p>
<p><em>(c) Show that $x''(t) + \lambda x(t) = 0$ for $0 &lt;t&lt;\pi$</em></p>
<p><em>proof</em>. Note that $i'(0) = 0$
so that 
\begin{align*}
0 &amp;= \int_0^\pi x'(t)y'(t)dt -\lambda \int_0^\pi x(t)y(t)dt\\
&amp;= x'(t)y(t)\vert^\pi_0 - \int_0^\pi x''(t)y(t)dt -\lambda\int_0^\pi x(t)y(t)dt&amp;\text{integration by parts}\\
&amp;= 0 - \int_0^\pi x''(t)y(t) + \lambda x(t)y(t)dt\\
0 &amp;= \int_0^\pi (x''(t) + \lambda x(t))y(t)dt
\end{align*}
To satisfy this equation for all $y\in\mathcal A$, we must have $x''(t) + \lambda x(t) = 0$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-2">Example 2<a class="anchor-link" href="#Example-2">&#182;</a></h2><p>_Let $\mathcal A = \{u:[0,1]\rightarrow\mathbb R^3\mid u\in C^1 u(0)=A, u(1)=B\}$, consider the "holonomic constraints" problem
\begin{align*}
\text{minimize}\quad F[u(\cdot)]:=\int_0^1 \sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}dt\\
\text{subject to}\quad u\in\mathcal A, G(u(t)) = u_1(t)^2 + u_2(t)^2 = 1
\end{align*}
Find EL equations for this problem_</p>
\begin{align*}
L(t, z_1,z_2,z_3,p_1,p_2,p_3) &amp;= (p_1^2 + p_2^2+p_3^2)^{1/2}\\
L_z &amp;= 0\\
L_{p_i} &amp;= p_i(p_1^2 + p_2^2+p_3^2)^{-1/2} \\
&amp;= \frac{u'_i(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}}\\
\nabla_u G &amp;= (2u_1(t), 2u_2(t), 0)\\
\frac{\partial F}{\partial u_1} &amp;= 0 - \frac{d}{dt}L_{p_i}\\
&amp;= -\frac{d}{dt} \frac{u'_i(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}}
\end{align*}<p>Therefore, for some $\lambda:[0, 1]\rightarrow \mathbb R$, the EL equations is 
$$\begin{bmatrix}
-\frac{d}{dt} \frac{u'_1(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}}\\
-\frac{d}{dt} \frac{u'_2(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}}\\
-\frac{d}{dt} \frac{u'_3(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2 + u'_3(t)^2}}
\end{bmatrix} + \lambda(t)
\begin{bmatrix}
2u_1(t)\\
2u_2(t)\\
0
\end{bmatrix} =\begin{bmatrix}
0\\0\\0
\end{bmatrix} $$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-3">Example 3<a class="anchor-link" href="#Example-3">&#182;</a></h2><p><em>Let $\mathcal A = \{u:[0,1]\rightarrow\mathbb R^2\mid u\in C^1, u(0)=A, u(1)=B\}$, consider the "holonomic constraints" problem</em>
\begin{align*}
\text{minimize}\quad F[u(\cdot)]:=\int_0^1 \sqrt{u'_1(t)^2 + u'_2(t)^2}dt\\
\text{subject to}\quad u\in\mathcal A, G(u(t)) = u_1(t) + u_2(t)^2 = 1
\end{align*}</p>
<p><em>(a) Find the EL Equation</em></p>
<p>We can easily have the EL equations being
$$\begin{bmatrix}
-\frac{d}{dt} \frac{u'_1(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2}}\\
-\frac{d}{dt} \frac{u'_2(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2}}
\end{bmatrix} + \lambda(t)
\begin{bmatrix}
1\\
2u_2(t)
\end{bmatrix} =\begin{bmatrix}
0\\0
\end{bmatrix} $$</p>
<p><em>(b) Solve the problem as a unconstrainted problem</em></p>
<p>Consider $u_2\in \{v:[0, 1]\rightarrow \mathbb R\mid v(0) = a, v(1) = b, v\in C^1\}$, the original problem is equivalent to minimize 
\begin{align*}
F[v(\cdot)] &amp;= \int_0^1 \sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}dt\\
&amp;= \int_0^1 \sqrt{u_2'(t)^2 + (-2u_2(t)u_2'(t))^2}\\
&amp;= \int_0^1 \sqrt{(1 + 4u_2(t)^2)u_2'(t)^2}dt\\
L(x, z, p) &amp;= \sqrt{(1+4z^2)p^2}\\
L_z &amp;= ((1+4z^2)p^2)^{-1/2}(4p^2z)\\
&amp;= \frac{4u_2(t)u_2'(t)^2}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}}\\
L_p &amp;= ((1+4z^2)p^2)^{-1/2}(1+4z^2)p\\
\frac{d}{dt}L_p &amp;= \frac{d}{dt}\frac{(1 + 4u_2(t)^2)u_2'(t)}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}}
\end{align*}
so that the EL equations give 
$$- \frac{d}{dt}\frac{(1 + 4u_2(t)^2)u_2'(t)}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}} + \frac{4u_2(t)u_2'(t)^2}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}}= 0 $$</p>
<p><em>(c) Show that (a) and (b) gives the same answer</em></p>
<p>From (a), we have 
$$\lambda(t) = \frac{d}{dt}\frac{u'_1(t)}{\sqrt{u'_1(t)^2 + u'_2(t)^2}}$$
From (b), note that $u_1' = \frac{d}{dt}(1-u_2^2) = -2u_2u_2'$
so that we can write
\begin{align*}</p>
<ul>
<li>\frac{d}{dt}\frac{(1 + 4u_2(t)^2)u_2'(t)}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}} + \frac{4u_2(t)u_2'(t)^2}{\sqrt{u_2'(t)^2 + \big[\frac{d}{dt}(1-u_2(t)^2)\big]^2}}&amp;= 0 \
-\frac{d}{dt}\frac{u_2'}{\sqrt{u_1'(t)^2 + u_2'(t)^2}} + \frac{d}{dt}\frac{2u_2(t)u_1'(t)}{{\sqrt{u_1'(t)^2 + u_2'(t)^2}}} + \frac{2u_2'(t)u_1'(t)}{{\sqrt{u_1'(t)^2 + u_2'(t)^2}}}&amp;=0\
-\frac{d}{dt}\frac{u_2'}{\sqrt{u_1'(t)^2 + u_2'(t)^2}} + 2u_2(t)\frac{d}{dt}\frac{u_1'(t)}{{\sqrt{u_1'(t)^2 + u_2'(t)^2}}} &amp;= 0\
-\frac{d}{dt}\frac{u_2'}{\sqrt{u_1'(t)^2 + u_2'(t)^2}} + 2u_2(t)\lambda(t) &amp;= 0\
\end{align*}</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-4">Example 4<a class="anchor-link" href="#Example-4">&#182;</a></h2><p><em>Let $u\in \mathcal A = \{u:[0, 1]\rightarrow \mathbb R\mid u\in C^1, u(0) = 0\}$</em>
\begin{align*}\text{minimize}\quad &amp;F[u] = \int_0^1L^F(x, u(x), u'(x))dx\\
\text{subject to}\quad &amp;G[u] =\int_0^1 u'(x)dx = a
\end{align*}</p>
<p><em>(a) Write the EL Equation</em></p>
\begin{align*}
\frac{\partial F}{\partial u} &amp;= L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x))\\
L^G(x, z, p) &amp;= p\\
\frac{d}{dt}L^G_p &amp;= \frac{d}{dt}1 = 0\\
\frac{\partial G}{\partial u} &amp;= 0
\end{align*}$$L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x)) - \lambda\times 0= 0$$<p>And $G[u] = \int_0^1 u'(x)dx = u(x)\mid^1_0 = u(1) - 0 = a$, note that this constraint makes the two end points of $u$ fixed, so EL equation is the only needed first order necessary condition.<br>
So that we have 
$$L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x))= 0$$
$$u(1) = a$$</p>
<p><em>(b) Formulated the problem as a unconstrianed problem and solve it</em></p>
<p>Note that $G[u] = u(1) - u(0) = u(1) = a$ so that the problem is to minimize $F[u]$ on $u\in \{u:[0, 1]\rightarrow \mathbb R\mid u\in C^1, u(0) = 0, u(1) =a\}$, hence the EL equation is simply 
$$L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x)) = 0$$</p>
<p><em>(c) Show (a) and (b) gives the same answer</em></p>
<p>Trivially, 
$$L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x))= 0$$
$$u(1) = a$$
$$u\in \{u:[0, 1]\rightarrow \mathbb R\mid u\in C^1, u(0) = 0\}$$
Is the same as 
$$L^F_z(x, u(x), u'(x)) - \frac{d}{dx}L^F_p(x, u(x), u'(x))= 0$$
$$u\in \{u:[0, 1]\rightarrow \mathbb R\mid u\in C^1, u(0) = 0, u(1) = a\}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-5">Example 5<a class="anchor-link" href="#Example-5">&#182;</a></h2><p><em>Consider the minimization problem in Q4, but the two endpoints are both unfixed, find the FONC</em></p>
<p>Note that the constraint $G[u] = \int_0^1 u'(x)dx = u(1) - u(0) = a$, so that we are optimize $F[u]$ on $\mathcal A := \{u[0, 1]\rightarrow \mathbb R\mid u\in C^1, u(1)-u(0) = a\}$.<br>
Consider test function $v$ s.t. $v(0) = v(1) = 0$.<br>
Assume $u_*$ is a minimizer, define 
$$f(s, t):\mathbb R^2\rightarrow \mathbb R := F[u_*(\cdot) + sv(\cdot) + t] = \int_0^1 L(x, u(x)+sv(x)+t, u'(x) + sv'(x))dx$$
so that $$\mathcal A = \{u_*+sv+t\mid s,t\in\mathbb R\}$$
Since $u_*$ is a minimizer, we must have $\nabla f = 0$
$$\frac{\partial}{\partial s}\mid_{(s,t)=(0, 0)}F = \int_0^1 L_z^F(\cdots)v(x) + L_p^G(\cdots)v'(x)dx = \int_0^1(L_z - \frac{d}{dx}L_p)v(x)dx$$
The computation of the above equation is identical to the proof of Euler Lagrange equation, and by fundamental lemma, we have must 
$$L_z(x, u(x), u'(x)) - \frac{d}{dx}L_p(x, u(x), u'(x)) = 0$$
Then, we also need to have
$$\frac{\partial}{\partial t}\mid_{(s,t) =(0,0)}F = \int_0^1 L_z^F(x, u(x), u'(x)) dx=0$$
so that FONC are 
$$L_z(x, u(x), u'(x)) - \frac{d}{dx}L_p(x, u(x), u'(x)) = 0$$
$$\int_0^1 L_z^F(x, u(x), u'(x)) dx=0$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-6">Example 6<a class="anchor-link" href="#Example-6">&#182;</a></h2><p><em>Prove Euler-Lagrange equation for isoperimetric problems</em></p>
<p><em>proof</em>. Take $v_2$ s.t. $\int_a^b \frac{\partial G}{\partial u}(u_*)(x)v_2(x)dx \neq 0$. Let $f(s, t) = F[u_* +sv_1 + tv_2]$ and $g(s, t) = G[u_*+sv_1+tv_2]$. 
Note that 
\begin{align*}
\frac{\partial}{\partial s}g(0, 0) &amp;= \int_a^b \frac{\partial}{\partial s}\mid_{(s, t)=(0, 0)}L^G(x, u_* + sv_1 + tv_2, u_*'+sv_1'+tv_2')dx\\
&amp;= \int_a^b L_z^G(\cdots)\frac{\partial}{\partial s}(u_*+sv_1+tv_2) + L_p^G(\cdots)\frac{\partial}{\partial s}(u_*'+sv_1'+tv_2')\\
&amp;= \int_a^b L_z^G(\cdots)v_1(x) + L_p^G(\cdots)v_1'(x)\\
&amp;=\int_a^b (L_z^G(x, u_*, u_*') - \frac{d}{dx}L_p^G(x, u_*, u_*'))v_1(x)dx\\
&amp;= \int_{a}^b \frac{\partial G}{\partial u}(u_*)(x)v_1(x)dx
\end{align*}
The above equation is obtained by integration by parts, the steps are identical to the computation for $\frac{d}{ds}\mid_{s=0}F[u+sv]$.<br>
With the similar derivations, we can show that 
$$\frac{\partial}{\partial t}g(0, 0) = \int_{a}^b \frac{\partial G}{\partial u}(u_*)(x)v_2(x)dx$$
$$\frac{\partial}{\partial t}f(0,0) = \int_{a}^b \frac{\partial F}{\partial u}(u_*)(x)v_1(x)dx$$
$$\frac{\partial}{\partial t}f(0,0) = \int_{a}^b \frac{\partial F}{\partial u}(u_*)(x)v_1(x)dx$$
Note that by our assumption, $\frac{\partial}{\partial t}g(0,0) = \int_{a}^b \frac{\partial G}{\partial u}(u_*)(x)v_2(x)dx\neq 0$ so that $\nabla g(0, 0) \neq 0$, therefore we can safely apply Lagrange multipliers, i.e. for some $\lambda$
\begin{align*}0 &amp;= \int_{a}^b \frac{\partial F}{\partial u}(u_*)(x)v_1(x)dx + \lambda \int_{a}^b \frac{\partial G}{\partial u}(u_*)(x)v_1(x)dx \\
&amp;= \int_a^b (\frac{\partial F}{\partial u} + \lambda \frac{\partial G}{\partial u})v_1(x)dx\\
0 &amp;= \int_{a}^b \frac{\partial F}{\partial u}(u_*)(x)v_2(x)dx + \lambda \int_{a}^b \frac{\partial G}{\partial u}(u_*)(x)v_2(x)dx \\
&amp;= \int_a^b (\frac{\partial F}{\partial u} + \lambda \frac{\partial G}{\partial u})v_2(x)dx\\
\end{align*}
By fundamental lemma, both equations lead to 
$$\frac{\partial F}{\partial u} + \lambda \frac{\partial G}{\partial u} = 0$$
a.k.a
$$L_z^F - \frac{d}{dx}L_p^F + \lambda(L_z^G - \frac{d}{dx}L_p^G) = 0$$
$$-\frac{d}{dx}(L^G+\lambda L^G)_p(x, u_*, u'_*) + (L^F+\lambda L^G)_z(x, u_*,u_*') = 0$$</p>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
