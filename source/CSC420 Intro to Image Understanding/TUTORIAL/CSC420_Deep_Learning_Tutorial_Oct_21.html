<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>CSC420_Deep_Learning_Tutorial_Oct_21 - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/index/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">CSC420_Deep_Learning_Tutorial_Oct_21</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %load csc420-tutorial/helper.py</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>
<span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>


<span class="k">def</span> <span class="nf">test_network</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">trainloader</span><span class="p">):</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

    <span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">trainloader</span><span class="p">)</span>
    <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

    <span class="c1"># Create Variables for the inputs and targets</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

    <span class="c1"># Clear the gradients from all Variables</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

    <span class="c1"># Forward pass, then backward pass, then update weights</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="k">return</span> <span class="kc">True</span>


<span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Imshow for Tensor.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">])</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">std</span> <span class="o">*</span> <span class="n">image</span> <span class="o">+</span> <span class="n">mean</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span>


<span class="k">def</span> <span class="nf">view_recon</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">recon</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Function for displaying an image (as a PyTorch Tensor) and its</span>
<span class="sd">        reconstruction also a PyTorch Tensor</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">recon</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_adjustable</span><span class="p">(</span><span class="s1">&#39;box-forced&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">view_classify</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;MNIST&quot;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Function for viewing an image and it&#39;s predicted classes.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">resize_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">ps</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;MNIST&quot;</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;Fashion&quot;</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;T-shirt/top&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Trouser&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Pullover&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Dress&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Coat&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Sandal&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Shirt&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Sneaker&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Bag&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Ankle Boot&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Class Probability&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Classifying-Fashion-MNIST">Classifying Fashion-MNIST<a class="anchor-link" href="#Classifying-Fashion-MNIST">&#182;</a></h1><p>Now it's your turn to build and train a neural network. You'll be using the <a href="https://github.com/zalandoresearch/fashion-mnist">Fashion-MNIST dataset</a>, a drop-in replacement for the MNIST dataset. MNIST is actually quite trivial with neural networks where you can easily achieve better than 97% accuracy. Fashion-MNIST is a set of 28x28 greyscale images of clothes. It's more complex than MNIST, so it's a better representation of the actual performance of your network, and a better representation of datasets you'll use in the real world.</p>
<p><img src='https://github.com/johntiger1/deep-learning-v2-pytorch/blob/master/intro-to-pytorch/assets/fashion-mnist-sprite.png?raw=1' width=500px></p>
<p>In this notebook, you'll build your own neural network. For the most part, you could just copy and paste the code from Part 3, but you wouldn't be learning. It's important for you to write the code yourself and get it to work. Feel free to consult the previous notebooks though as you work through this.</p>
<p>First off, let's load the dataset through torchvision.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">helper</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="k">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>

<span class="c1"># Define a transform to normalize the data</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                                <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,))])</span>
<span class="c1"># Download and load the training data</span>
<span class="n">trainset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span><span class="s1">&#39;~/.pytorch/F_MNIST_data/&#39;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">trainset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Download and load the test data</span>
<span class="n">testset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span><span class="s1">&#39;~/.pytorch/F_MNIST_data/&#39;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can see one of the images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">trainloader</span><span class="p">))</span>
<span class="n">helper</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Building-the-network">Building the network<a class="anchor-link" href="#Building-the-network">&#182;</a></h1><p>Here you should define your network. As with MNIST, each image is 28x28 which is a total of 784 pixels, and there are 10 classes. You should include at least one hidden layer. We suggest you use ReLU activations for the layers and to return the logits or log-softmax from the forward pass. It's up to you how many layers you add and the size of those layers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fully-Connected-Network">Fully Connected Network<a class="anchor-link" href="#Fully-Connected-Network">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TODO: Define your network architecture here</span>
<span class="k">class</span> <span class="nc">Classifier</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># make sure input tensor is flattened</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc4</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convolutional-Network">Convolutional Network<a class="anchor-link" href="#Convolutional-Network">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CNN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CNN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Train-the-network">Train the network<a class="anchor-link" href="#Train-the-network">&#182;</a></h1><p>Now you should create your network and train it. First you'll want to define <a href="http://pytorch.org/docs/master/nn.html#loss-functions">the criterion</a> (something like <code>nn.CrossEntropyLoss</code> or <code>nn.NLLLoss</code>) and <a href="http://pytorch.org/docs/master/optim.html">the optimizer</a> (typically <code>optim.SGD</code> or <code>optim.Adam</code>).</p>
<p>Then write the training code. Remember the training pass is a fairly straightforward process:</p>
<ul>
<li>Make a forward pass through the network to get the logits </li>
<li>Use the logits to calculate the loss</li>
<li>Perform a backward pass through the network with <code>loss.backward()</code> to calculate the gradients</li>
<li>Take a step with the optimizer to update the weights</li>
</ul>
<p>By adjusting the hyperparameters (hidden units, learning rate, etc), you should be able to get the training loss below 0.4.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TODO: Create the network, define the criterion and optimizer</span>
<span class="n">convolution</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">convolution</span><span class="p">:</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
  
<span class="k">else</span><span class="p">:</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">Classifier</span><span class="p">()</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.003</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">trainloader</span><span class="p">:</span>
        <span class="n">log_ps</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">log_ps</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Training loss: {running_loss/len(trainloader)}&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training loss: 0.3376594038644452
Training loss: 0.2663036148224685
Training loss: 0.23609930249467206
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_ps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[44]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-6.2102e+00, -1.0328e+01, -4.8783e+00, -1.3031e+01, -6.1587e-01,
         -6.1057e+00, -8.0402e-01, -1.2403e+01, -7.8539e+00, -1.0635e+01],
        [-7.5567e+00, -1.7907e+01, -6.5030e-02, -1.1012e+01, -1.2169e+01,
         -1.7189e+01, -2.7739e+00, -1.8936e+01, -1.4955e+01, -1.6334e+01],
        [-7.0544e+00, -9.5808e+00, -3.0829e+00, -3.9281e+00, -6.9089e-02,
         -1.1827e+01, -8.4215e+00, -1.2556e+01, -9.3856e+00, -1.2883e+01],
        [-5.7218e-01, -1.0255e+01, -6.7323e+00, -7.6740e+00, -5.6749e+00,
         -1.3393e+01, -8.4275e-01, -1.1619e+01, -1.0041e+01, -1.2695e+01],
        [-1.0021e+01, -1.4829e+01, -7.6011e+00, -1.2577e+01, -5.0457e+00,
         -1.6644e+01, -7.0129e-03, -1.7400e+01, -1.2738e+01, -1.5070e+01],
        [-1.2544e+01, -1.5084e+01, -1.4702e+01, -1.5032e+01, -1.6051e+01,
         -6.8937e+00, -1.4109e+01, -2.2435e-03, -8.9539e+00, -6.8196e+00],
        [-1.6311e-02, -1.1233e+01, -5.5455e+00, -1.1832e+01, -1.0399e+01,
         -1.6918e+01, -4.4063e+00, -1.4357e+01, -1.0772e+01, -1.4680e+01],
        [-7.4888e+00, -1.7327e+01, -2.7294e-03, -1.6379e+01, -1.0494e+01,
         -1.5038e+01, -6.1478e+00, -2.0371e+01, -1.6736e+01, -1.6054e+01],
        [-9.5696e+00, -1.3977e+01, -1.0031e+01, -1.3495e+01, -1.1953e+01,
         -5.2265e+00, -7.4260e+00, -9.4170e+00, -6.1967e-03, -1.1994e+01],
        [-1.2946e+01, -5.8412e-06, -1.4980e+01, -1.2847e+01, -1.4813e+01,
         -1.7321e+01, -1.6442e+01, -1.6752e+01, -1.9615e+01, -1.7845e+01],
        [-9.8288e+00, -6.5436e-04, -1.1577e+01, -7.5886e+00, -1.0972e+01,
         -1.2281e+01, -1.0637e+01, -1.0718e+01, -1.1305e+01, -1.2343e+01],
        [-8.9525e+00, -1.3697e+01, -1.2286e+01, -1.8821e-04, -1.6896e+01,
         -1.6465e+01, -9.8657e+00, -1.4146e+01, -1.5458e+01, -1.6212e+01],
        [-1.5389e+01, -2.3504e+01, -2.1391e+01, -3.1783e+01, -2.3136e+01,
         -1.6689e-06, -1.6465e+01, -1.9755e+01, -1.4222e+01, -1.4203e+01],
        [-4.6708e+00, -1.2432e+01, -1.1795e+01, -9.3834e+00, -8.0063e+00,
         -1.8463e+01, -9.8991e-03, -1.5125e+01, -9.7907e+00, -1.6136e+01],
        [-8.5816e+00, -1.3522e+01, -5.1978e+00, -1.3283e+01, -1.1116e+00,
         -1.3845e+01, -4.0764e-01, -1.5846e+01, -1.0949e+01, -1.0611e+01],
        [-9.4754e+00, -2.1229e-04, -1.2176e+01, -9.0455e+00, -1.1918e+01,
         -1.3471e+01, -1.3618e+01, -1.5511e+01, -1.2693e+01, -1.6756e+01],
        [-2.6621e+00, -1.5977e+01, -1.1458e+01, -1.2631e+01, -9.5376e+00,
         -2.0081e+01, -7.2452e-02, -1.5626e+01, -1.3556e+01, -1.7075e+01],
        [-1.1561e+01, -2.3584e+01, -1.1945e-03, -1.4981e+01, -7.1048e+00,
         -1.7964e+01, -7.9227e+00, -2.0951e+01, -1.4789e+01, -1.7571e+01],
        [-8.1030e+00, -1.8535e+01, -4.1458e-03, -1.3002e+01, -7.8490e+00,
         -1.5165e+01, -5.6717e+00, -1.9209e+01, -1.7900e+01, -1.7298e+01],
        [-3.6454e+00, -1.1683e+01, -9.3795e+00, -6.1881e+00, -9.0619e+00,
         -1.1928e+01, -2.9777e-02, -1.3467e+01, -6.9528e+00, -1.3541e+01],
        [-2.7233e-01, -6.2433e+00, -4.0122e+00, -2.6962e+00, -7.7236e+00,
         -1.0051e+01, -1.9000e+00, -9.5186e+00, -8.0756e+00, -7.6864e+00],
        [-6.9046e+00, -1.2506e+01, -3.5140e-01, -1.2923e+01, -1.2456e+00,
         -1.6367e+01, -4.8912e+00, -1.5318e+01, -1.2811e+01, -1.1461e+01],
        [-6.5842e+00, -4.4310e-02, -8.5456e+00, -3.2046e+00, -8.8017e+00,
         -1.0360e+01, -7.3868e+00, -8.1367e+00, -9.5578e+00, -1.0631e+01],
        [-6.7479e+00, -8.6218e+00, -5.2846e+00, -6.0548e-02, -3.5899e+00,
         -8.5696e+00, -3.7383e+00, -9.9269e+00, -7.2824e+00, -1.1838e+01],
        [-7.0889e+00, -1.6040e+01, -1.0547e+01, -1.4531e+01, -1.0802e+01,
         -4.1652e-03, -8.9517e+00, -5.8639e+00, -8.1042e+00, -1.2726e+01],
        [-5.1816e+00, -9.0156e+00, -8.6820e+00, -2.1410e+00, -5.9826e+00,
         -3.7014e+00, -4.3171e+00, -6.4600e+00, -1.8447e-01, -5.8444e+00],
        [-1.3640e+01, -1.8091e+01, -1.5777e+01, -1.7885e+01, -1.8284e+01,
         -6.6597e+00, -1.4510e+01, -1.4113e-03, -1.2238e+01, -9.0107e+00],
        [-7.0057e+00, -1.1376e+01, -5.8313e-01, -1.2466e+01, -8.5998e-01,
         -1.3789e+01, -4.0340e+00, -1.3633e+01, -1.0606e+01, -1.0441e+01],
        [-1.4275e+01, -1.4849e+01, -1.3937e+01, -1.4159e+01, -1.5039e+01,
         -8.7900e+00, -1.3685e+01, -6.7116e-04, -1.0990e+01, -7.6053e+00],
        [-2.3889e-01, -6.3481e+00, -3.7021e+00, -1.8243e+00, -7.7271e+00,
         -1.2130e+01, -3.7509e+00, -1.0640e+01, -7.1756e+00, -1.0889e+01],
        [-1.0002e+01, -1.5142e+01, -1.4081e+01, -1.4415e+01, -1.7935e+01,
         -2.4116e+00, -1.2613e+01, -9.4226e-02, -8.5255e+00, -1.3148e+01],
        [-1.1452e+01, -1.4599e+01, -1.0083e+01, -1.3244e+01, -1.4241e+01,
         -4.7697e+00, -1.0119e+01, -9.2891e-02, -9.4971e+00, -2.5251e+00]],
       grad_fn=&lt;LogSoftmaxBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;

<span class="kn">import</span> <span class="nn">helper</span>

<span class="c1"># Test out your network!</span>

<span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">testloader</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">if</span> <span class="n">convolution</span><span class="p">:</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># TODO: Calculate the class probabilities (softmax) for img</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>

<span class="c1"># Plot the image and probabilities</span>
<span class="n">helper</span><span class="o">.</span><span class="n">view_classify</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;Fashion&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AABJRU5ErkJggg==
"
width=423
height=206
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Evaluation">Evaluation<a class="anchor-link" href="#Evaluation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
    <span class="n">log_ps</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

    <span class="c1"># get the predictions: argmax etc.</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_ps</span><span class="p">)</span>
    <span class="n">top_p</span><span class="p">,</span> <span class="n">top_class</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">equals</span> <span class="o">=</span> <span class="n">top_class</span> <span class="o">==</span> <span class="n">labels</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">top_class</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">equals</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">))</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Accuracy: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">testloader</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Test Accuracy: 0.896
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if you want to do eval after every epoch</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Classifier</span><span class="p">()</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.003</span><span class="p">)</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">train_losses</span><span class="p">,</span> <span class="n">test_losses</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="p">(</span><span class="n">trainloader</span><span class="p">):</span>
        
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        
        <span class="n">log_ps</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">log_ps</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Turn off gradients for validation, saves memory and computations</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
                <span class="n">log_ps</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
                <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">log_ps</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
                
                <span class="n">ps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_ps</span><span class="p">)</span>
                <span class="n">top_p</span><span class="p">,</span> <span class="n">top_class</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">equals</span> <span class="o">=</span> <span class="n">top_class</span> <span class="o">==</span> <span class="n">labels</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">top_class</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">accuracy</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">equals</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">))</span>
                
        <span class="n">train_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">running_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">trainloader</span><span class="p">))</span>
        <span class="n">test_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">testloader</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">.. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">epochs</span><span class="p">),</span>
              <span class="s2">&quot;Training Loss: </span><span class="si">{:.3f}</span><span class="s2">.. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">running_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">trainloader</span><span class="p">)),</span>
              <span class="s2">&quot;Test Loss: </span><span class="si">{:.3f}</span><span class="s2">.. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_loss</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">testloader</span><span class="p">)),</span>
              <span class="s2">&quot;Test Accuracy: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">accuracy</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">testloader</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch: 1/5..  Training Loss: 0.510..  Test Loss: 0.445..  Test Accuracy: 0.840
Epoch: 2/5..  Training Loss: 0.392..  Test Loss: 0.397..  Test Accuracy: 0.856
Epoch: 3/5..  Training Loss: 0.362..  Test Loss: 0.400..  Test Accuracy: 0.851
Epoch: 4/5..  Training Loss: 0.337..  Test Loss: 0.406..  Test Accuracy: 0.853
Epoch: 5/5..  Training Loss: 0.318..  Test Loss: 0.380..  Test Accuracy: 0.862
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
