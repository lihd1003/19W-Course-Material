<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Conditioning of Linear Equation Systems - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/index/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">Conditioning of Linear Equation Systems</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conditioning-for-$Ax-=-b$">Conditioning for $Ax = b$<a class="anchor-link" href="#Conditioning-for-$Ax-=-b$">&#182;</a></h3><p>Input $A,b$, output $x$</p>
<p>Assume $A_{n\times n}$ is non-singular (square matrix), suppose changing $b\rightarrow \hat b$, denote $\Delta b = b - \hat b$.<br>
Consider $\Delta x = x - \hat x$, where $A\hat x = \hat b$. Having $\frac{\|\Delta b\|}{\|b\|}$, WTF $\frac{\|\Delta x\|}{\|x\|}$</p>
$$\|Ax\| = \frac{\|Ax\|\|x\|}{\|x\|} \leq \max_{x\neq 0}\frac{\|Ax\|\|x\|}{\|x\|} = \|A\|\|x\|$$<p>So that
$$\|b\| = \|Ax\| \leq \|A\|\|x\|$$
$$\|\Delta x\| = \|A^{-1}\Delta b\| \leq \|A^{-1}\|\|\Delta b\|$$
Then, using the two inequalities
$$\frac{\|\Delta x\|}{\|A\|\|x\|} \leq \frac{\|A^{-1}\|\|\Delta b\|}{\|A\|\|x\|} \leq \frac{\|A^{-1}\|\|\Delta b\|}{\|b\|}$$
$$\frac{\|\Delta x\|}{\|x\|} \leq \|A\|\|A^{-1}\|\frac{\|\Delta b\|}{\|b\|}$$
Define $Cond(A) = \|A\|\|A^{-1}\|$</p>
<p>Also, note that $Cond(A)^{-1} \frac{\|\Delta b\|}{\|b\|} &lt; \frac{\|\Delta\|}{\|x\|} \leq Cond(A)\frac{\Delta b\|}{\|b\|}$<br>
And $Cond(A)^{-1} \leq Cond(A)\Rightarrow Cond(A)^2 \geq 1\Rightarrow Cond(A) \geq 1$</p>
<p>Also, noting that the <strong>lemma</strong> is only true if the norm induced by vector norm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Theorem</strong> $\forall A\in \mathbb R^n \times \mathbb R^n. Cond(A) \geq 1$ (Another proof)</p>
<p><em>proof</em>. $1 = \|I\| = \|A^{-1}A\| \leq \|A^{-1}\|\|A\| = Cond(A)$ by triangular inequality of the norm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Theorem</strong> $\frac{\|\Delta x\|}{\|x\|} \leq Cond(A)\big(\frac{\|\Delta b\|}{\|b\|} + \frac{\|\Delta A\|}{\|A\|}\big)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For $2\times 2$ matrices 
$$A = \begin{bmatrix} a&amp;b\\c&amp;d\end{bmatrix}, A^{-1} = \det(A)^{-1}\begin{bmatrix}d&amp;-b\\-c&amp;a\end{bmatrix}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example">Example<a class="anchor-link" href="#Example">&#182;</a></h4><p>Given $A = \begin{bmatrix}3&amp;-1\\-2&amp;1\end{bmatrix}$ with $\|\cdot\|_\infty$</p>
<p>Then, $A^{-1} = \begin{bmatrix}1&amp;1\\2&amp;3\end{bmatrix}$, $\|A\|_\infty = \max(3 + 1, 2 + 1)=4, \|A^{-1}\| = 5$<br>
Therefore, $Cond(A) = 4\times 5 = 20$, which is good-conditioning.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define $y:= A^{-1}x$ so that $x\neq 0 \Leftrightarrow y\neq 0$<br>
$$\|A^{-1}\| = \max \frac{\|A^{-1}x\|}{\|x\|} = \max\frac{\|y\|}{\|Ay\|} = \max (\frac{\|Ay\|}{\|y\|}^{-1}) = \min(\frac{\|Ax\|}{\|x\|})^{-1}$$
So that 
$$\|A\|\|A^{-1}\| = \frac{\max(\frac{\|Ax\|}{\|x\|})}{\min(\frac{\|Ax\|}{\|x\|})} = \frac{\max_{\|x\|=1}\|Ax\|}{\min_{\|x\|=1}\|Ax\|}$$
Is the ratio between how much $A$ expands $x$ and how much $A$ contracts $x$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Properties-of-Conditioning-Numbers">Properties of Conditioning Numbers<a class="anchor-link" href="#Properties-of-Conditioning-Numbers">&#182;</a></h3><p>$Cond(A)\geq 1$</p>
<p>$Cond(I) = \|I\|\|I^{-1}\| = 1$</p>
<p>$Cond(\gamma A) = |\gamma|\|A\||\gamma^{-1}|\|A^{-1}\| = Cond(A)$</p>
<h4 id="Diagonal-matrices">Diagonal matrices<a class="anchor-link" href="#Diagonal-matrices">&#182;</a></h4><p>If $D$ is a diagonal matrix of $diag = \{d_1, d_2,...,d_n\}, di\neq 0$, then $$Cond_\infty(D) = \frac{\max(diag)}{\max(diag^{-1})} = \frac{\max(diag)}{\min(diag)}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Near-singular">Near singular<a class="anchor-link" href="#Near-singular">&#182;</a></h4><p>If changing some elements of $A$ by $A+E$, then it will be singular.</p>
$$\frac{\|E\|}{\|A\|}\propto Cond(A)^{-1}$$<p>So that the larger conditioning number indicates that $A$ is closer to be near singular</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\det(A) = 0 \Leftrightarrow A$ is singular,<br>
If the $\det$ is small, then it may not be near singular ($\det(\gamma I) = \gamma$ can be arbitrarily small while still away from singular)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Estimate-matrix-inverse">Estimate matrix inverse<a class="anchor-link" href="#Estimate-matrix-inverse">&#182;</a></h4><p>Note that computing $A^{-1}$ requires $\sim n^3$ operations (by Gaussian elimination). To estimate $\|A^{-1}\|$ for computing $Cond(A)$
$$y=Az\Rightarrow z = A^{-1}y \Rightarrow \|z\| = \|A^{-1}y\| \leq \|A^{-1}\|\|y\|\Rightarrow \frac{\|z\|}{\|y\|} \leq \|A^{-1}\|$$
Therefore, choose a sequence of $z$'s to try to make $\frac{\|z\|}{\|y\|}$ as large as possible (iterative estimating)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Rounding-errors">Rounding errors<a class="anchor-link" href="#Rounding-errors">&#182;</a></h4><p>Define $\Delta A = A - \hat A, \Delta b = b - \hat b$, then $\frac{\|\Delta A\|}{\|A\|}, \|\Delta b\| \approx \epsilon_{mach}$. Then 
$$\frac{\|x-\hat x\|}{\|x\|} \approx Cond(A)(2\epsilon_{mach})$$</p>
<p>Consider $Ax=b$ computed to get $\hat x$, define residual $r := b - A\hat x = b - \hat b = \Delta b$<br>
Define $\Delta x= x - \hat x, $ then, 
$$\frac{\|\Delta x\|}{\|x\|} \leq Cond(A)\frac{\|r\|}{\|b\|}$$
Nearly all good linear equation solvers have small $\|r\|$ so it's only a matter of the conditioning number</p>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
