---
title: Conditioning of Linear Equation Systems
order: 40
---
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Conditioning for $Ax = b$</h1>
<p>Input $A,b$, output $x$</p>
<p>Assume $A_{n\times n}$ is non-singular (square matrix), suppose changing $b\rightarrow \hat b$, denote $\Delta b = b - \hat b$.<br>
Consider $\Delta x = x - \hat x$, where $A\hat x = \hat b$. Having $\frac{\|\Delta b\|}{\|b\|}$, WTF $\frac{\|\Delta x\|}{\|x\|}$</p>
$$\|Ax\| = \frac{\|Ax\|\|x\|}{\|x\|} \leq \max_{x\neq 0}\frac{\|Ax\|\|x\|}{\|x\|} = \|A\|\|x\|$$<p>So that
$$\|b\| = \|Ax\| \leq \|A\|\|x\|$$
$$\|\Delta x\| = \|A^{-1}\Delta b\| \leq \|A^{-1}\|\|\Delta b\|$$
Then, using the two inequalities
$$\frac{\|\Delta x\|}{\|A\|\|x\|} \leq \frac{\|A^{-1}\|\|\Delta b\|}{\|A\|\|x\|} \leq \frac{\|A^{-1}\|\|\Delta b\|}{\|b\|}$$
$$\frac{\|\Delta x\|}{\|x\|} \leq \|A\|\|A^{-1}\|\frac{\|\Delta b\|}{\|b\|}$$
Define $Cond(A) = \|A\|\|A^{-1}\|$</p>
<p>Also, note that $Cond(A)^{-1} \frac{\|\Delta b\|}{\|b\|} &lt; \frac{\|\Delta\|}{\|x\|} \leq Cond(A)\frac{\Delta b\|}{\|b\|}$<br>
And $Cond(A)^{-1} \leq Cond(A)\Rightarrow Cond(A)^2 \geq 1\Rightarrow Cond(A) \geq 1$</p>
<p>Also, noting that the <strong>lemma</strong> is only true if the norm induced by vector norm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Theorem</strong> $\forall A\in \mathbb R^n \times \mathbb R^n. Cond(A) \geq 1$ (Another proof)</p>
<p><em>proof</em>. $1 = \|I\| = \|A^{-1}A\| \leq \|A^{-1}\|\|A\| = Cond(A)$ by triangular inequality of the norm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Theorem</strong> $\frac{\|\Delta x\|}{\|x\|} \leq Cond(A)\big(\frac{\|\Delta b\|}{\|b\|} + \frac{\|\Delta A\|}{\|A\|}\big)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For $2\times 2$ matrices 
$$A = \begin{bmatrix} a&amp;b\\c&amp;d\end{bmatrix}, A^{-1} = \det(A)^{-1}\begin{bmatrix}d&amp;-b\\-c&amp;a\end{bmatrix}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Example</h3>
<p>Given $A = \begin{bmatrix}3&amp;-1\\-2&amp;1\end{bmatrix}$ with $\|\cdot\|_\infty$</p>
<p>Then, $A^{-1} = \begin{bmatrix}1&amp;1\\2&amp;3\end{bmatrix}$, $\|A\|_\infty = \max(3 + 1, 2 + 1)=4, \|A^{-1}\| = 5$<br>
Therefore, $Cond(A) = 4\times 5 = 20$, which is good-conditioning.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define $y:= A^{-1}x$ so that $x\neq 0 \Leftrightarrow y\neq 0$<br>
$$\|A^{-1}\| = \max \frac{\|A^{-1}x\|}{\|x\|} = \max\frac{\|y\|}{\|Ay\|} = \max (\frac{\|Ay\|}{\|y\|}^{-1}) = \min(\frac{\|Ax\|}{\|x\|})^{-1}$$
So that 
$$\|A\|\|A^{-1}\| = \frac{\max(\frac{\|Ax\|}{\|x\|})}{\min(\frac{\|Ax\|}{\|x\|})} = \frac{\max_{\|x\|=1}\|Ax\|}{\min_{\|x\|=1}\|Ax\|}$$
Is the ratio between how much $A$ expands $x$ and how much $A$ contracts $x$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Properties of Conditioning Numbers</h1>
<p>$Cond(A)\geq 1$</p>
<p>$Cond(I) = \|I\|\|I^{-1}\| = 1$</p>
<p>$Cond(\gamma A) = |\gamma|\|A\||\gamma^{-1}|\|A^{-1}\| = Cond(A)$</p>
<h2>Diagonal matrices</h2>
<p>If $D$ is a diagonal matrix of $diag = \{d_1, d_2,...,d_n\}, di\neq 0$, then $$Cond_\infty(D) = \frac{\max(diag)}{\max(diag^{-1})} = \frac{\max(diag)}{\min(diag)}$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Near singular</h2>
<p>If changing some elements of $A$ by $A+E$, then it will be singular.</p>
$$\frac{\|E\|}{\|A\|}\propto Cond(A)^{-1}$$<p>So that the larger conditioning number indicates that $A$ is closer to be near singular</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\det(A) = 0 \Leftrightarrow A$ is singular,<br>
If the $\det$ is small, then it may not be near singular ($\det(\gamma I) = \gamma$ can be arbitrarily small while still away from singular)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Estimate matrix inverse</h2>
<p>Note that computing $A^{-1}$ requires $\sim n^3$ operations (by Gaussian elimination). To estimate $\|A^{-1}\|$ for computing $Cond(A)$
$$y=Az\Rightarrow z = A^{-1}y \Rightarrow \|z\| = \|A^{-1}y\| \leq \|A^{-1}\|\|y\|\Rightarrow \frac{\|z\|}{\|y\|} \leq \|A^{-1}\|$$
Therefore, choose a sequence of $z$'s to try to make $\frac{\|z\|}{\|y\|}$ as large as possible (iterative estimating)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Rounding errors</h2>
<p>Define $\Delta A = A - \hat A, \Delta b = b - \hat b$, then $\frac{\|\Delta A\|}{\|A\|}, \|\Delta b\| \approx \epsilon_{mach}$. Then 
$$\frac{\|x-\hat x\|}{\|x\|} \approx Cond(A)(2\epsilon_{mach})$$</p>
<p>Consider $Ax=b$ computed to get $\hat x$, define residual $r := b - A\hat x = b - \hat b = \Delta b$<br>
Define $\Delta x= x - \hat x, $ then, 
$$\frac{\|\Delta x\|}{\|x\|} \leq Cond(A)\frac{\|r\|}{\|b\|}$$
Nearly all good linear equation solvers have small $\|r\|$ so it's only a matter of the conditioning number</p>

</div>
</div>
</div>
 

