<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Practice Problems - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/table_of_content/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">Practice Problems</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">Sleuth3</span><span class="p">)</span>
<span class="n">elmasu</span> <span class="o">=</span> <span class="n">case2201</span>
<span class="n">Age</span> <span class="o">=</span> <span class="n">elmasu</span><span class="o">$</span><span class="n">Age</span>
<span class="n">Matings</span> <span class="o">=</span> <span class="n">elmasu</span><span class="o">$</span><span class="n">Matings</span>

<span class="n">fitllm</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">Matings</span><span class="o">~</span><span class="n">Age</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">poisson</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fitllm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = Matings ~ Age, family = poisson)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.80798  -0.86137  -0.08629   0.60087   2.17777  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.58201    0.54462  -2.905  0.00368 ** 
Age          0.06869    0.01375   4.997 5.81e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 75.372  on 40  degrees of freedom
Residual deviance: 51.012  on 39  degrees of freedom
AIC: 156.46

Number of Fisher Scoring iterations: 5
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="n">fitho</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">Matings</span><span class="o">~</span><span class="n">Age</span> <span class="o">+</span> <span class="nf">I</span><span class="p">(</span><span class="n">Age^2</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="n">poisson</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fitho</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
Call:
glm(formula = Matings ~ Age + I(Age^2), family = poisson)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8470  -0.8848  -0.1122   0.6580   2.1134  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -2.8574060  3.0356383  -0.941    0.347
Age          0.1359544  0.1580095   0.860    0.390
I(Age^2)    -0.0008595  0.0020124  -0.427    0.669

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 75.372  on 40  degrees of freedom
Residual deviance: 50.826  on 38  degrees of freedom
AIC: 158.27

Number of Fisher Scoring iterations: 5
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li><p>Consider the elephant mating example from lecture.</p>
<ol>
<li><em>Both the binomial and the Poisson distributions provide probability models for counts. Is the binomial distribution appropriate for the number of successful matings of the male African elephants?</em><br>
No, the binomial distribution has a upper bound for the number of success. (Number of success in a definite number of trials). </li>
<li><em>For the model fit in lecture, interpret the coefficient of age.</em><br>
Keeping other explanatory variables constant, one year increase in age will increase the number of matings by $e^{\beta_1}-1 = e^{0.0687}-1=0.07$</li>
<li><em>Consider the plot of the number of matings versus age. The spread of the responses is larger for larger values of the mean response. Should we be concerned?</em><br>
No, the model assumes the underlying distribution is Poisson, where $E(X)=var(X)=\mu$. Therefore, the spread will increase as the increase of of the mean response </li>
<li><em>From the estimated log-linear regression of the elephants' successful matings on age, what are the mean and variance of counts of successful matings (in the 8 years of the study) for the elephants who are aged 25 years at the beginning of the observation period? What are the mean and variance for elephants who are aged 45 years?</em>
For 25 years old: mean = variance = $e^{-1.582+(0.0687)25}=1.15$
For 25 years old: mean = variance = $e^{-1.582+(0.0687)45}=4.53$</li>
<li><em>While it is hypothesized that the number of matings increases with age, there
may be an optimal age for matings where, for older elephants the number of
matings starts to decline. One way to investigate this is to add a quadratic term
for age into the model to allow the log of the mean number of matings to reach
a peak. Does the inclusion in the model of $age^2$ improve the fit?</em><br>
By Wald test, since $p=0.669$, we cannot reject the null hypothesis, there is no evidence that the higher order term improve the fit</li>
</ol>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>What is the difference between a log-linear model and a linear model after the log transformation of the response?</li>
</ol>
<p>For log-linear model, mean is $\mu$, the model is $\log(\mu)=X\beta$.</p>
<p>For SLR with transformation, the model is expressed in terms of the mean of the log of $Y$ with different model assumptions.</p>
<ul>
<li>different variance</li>
<li>different test procedures and diagnosis</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Why are ordinary residuals $y_i-\hat\mu_i$ not particularly useful for Poisson regression?</li>
</ol>
<p>Because the variance in Poisson model is not constant. The residuals with larger means will have larger variances. So if an observation has
a large residual it is diffcult to know whether it is an outlier or an observation from
a distribution with larger variance than the others. Residuals that are studentized
so that they have the same variance are more useful for identifying outliers.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Consider the deviance goodness-of-t test.<ol>
<li><em>Under what conditions is it valid for Poisson regression?</em><br>
The sample size for each group is large enough. </li>
<li><em>When it is valid, what possibilities are suggested by a small p-value?</em>
The Poisson distribution is an inadequate model, the explanatory variables are inadequate, or there are some outliers. </li>
<li><em>Large p-value?</em><br>
Model is correct, or there is insufficient data to detect any inadequacies. </li>
</ol>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Because the underlying distribution is Poission. The likelihood function is
$$\prod_1^n \frac{\mu_i^{y_i}e^{-\mu_i}}{y_i!}=\frac{e^{-\sum \mu_i}\prod \mu_i^{y_i}}{\prod y_i!}$$
Take log
$$=-\sum \mu_i + \sum y_i \log(mu_i) - \sum \log(y_i!)$$
Where $\mu_i = e^{X_{\cdot,i}\beta}$ (X: the ith observation)</li>
</ol>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
