<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Factor independence - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/table_of_content/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">Factor independence</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Case-Study:-Framingham-Heart-Study">Case Study: Framingham Heart Study<a class="anchor-link" href="#Case-Study:-Framingham-Heart-Study">&#182;</a></h2><p>Data considered:</p>
<ul>
<li>n = 1329 men</li>
<li>X = Cholesterol measurement in 1948 (mg/dl)</li>
<li>Y = after 10 years, did they developed CVD (present/absernt)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Binomial-Sampling">Binomial Sampling<a class="anchor-link" href="#Binomial-Sampling">&#182;</a></h4><p>Let $\pi_H=p(present\mid high),\pi_L = P(present\mid low)$.</p>
<p>Hypothese: $H_0: \pi_H = \pi_L, H_a: \pi_H \neq \pi_L$</p>
<p>Assumptions:</p>
<ul>
<li>depending on level of cholesterol, each person is a Bernoulli trial with chance of developing CVD as $n_H = 284, n_L = 1043$. </li>
<li>Then for fixed $n_H, n_L$, the count of the number of people who develop CVD $y_H\sim Binomial(n_H=286,\pi_H)$ $y_L\sim Binomial(n_L=1043,\pi_L)$</li>
<li>Then estimate of $\pi_H-\pi_L$ is $\hat\pi_H-\hat\pi_L$ where $\hat\pi_H = y_H/n_H, \hat\pi_L = y_L/n_L$ are the sample proportions.</li>
<li>$var(\hat\pi_H-\hat\pi_L) = var(\hat\pi_H) + var(\hat\pi_L)\\=n_H\pi_H(1-\pi_H)/n^2_H + n_L\pi_L(1-\pi_L)/n^2_L\\= \pi_H(1-\pi_H)/n_H+\pi_L(1-\pi_L)/n_L$</li>
<li>$se(\hat\pi_H-\hat\pi_L) = \sqrt{\hat\pi_c(1-\hat\pi_c)(n_H^{-1}+n_L^{-1})}$ where $\hat\pi_c=\frac{y_L+y_H}{n+L + n_H}$ is the combined sample proportion</li>
<li>By CLT, the test statistic $\sim N(0,1)$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test statistic: $\frac{\hat\pi_H-\hat\pi_L}{se(\hat\pi_H-\hat\pi_L)}=5.575$</p>
<p>p-value $2P(Z\geq 5.575)&lt;0.05$</p>
<p>Conclusion: We have strong evidence that the probability of developing CVD is not the same for High and Low cholesterol groups.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="n">cvd</span><span class="o">&lt;-</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">41</span><span class="p">,</span><span class="m">245</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">992</span><span class="p">),</span> <span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">dimnames</span><span class="p">(</span><span class="n">cvd</span><span class="p">)</span><span class="o">&lt;-</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="s">&quot;Low&quot;</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Present&quot;</span><span class="p">,</span><span class="s">&quot;Absent&quot;</span><span class="p">))</span>
<span class="nf">names</span><span class="p">(</span><span class="nf">dimnames</span><span class="p">(</span><span class="n">cvd</span><span class="p">))</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Cholesterol&quot;</span><span class="p">,</span><span class="s">&quot;Cardio Vascular Disease&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">cvd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>           Cardio Vascular Disease
Cholesterol Present Absent
       High      41    245
       Low       51    992
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># estimate for pi</span>
<span class="n">pi_h</span> <span class="o">=</span> <span class="m">41</span><span class="o">/</span><span class="p">(</span><span class="m">41+245</span><span class="p">)</span>
<span class="n">pi_l</span> <span class="o">=</span> <span class="m">51</span><span class="o">/</span><span class="p">(</span><span class="m">51+992</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">pi_h</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">pi_l</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] 0.1433566
[1] 0.04889741
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># sample size </span>
<span class="n">n_h</span> <span class="o">=</span> <span class="m">41</span> <span class="o">+</span> <span class="m">245</span>
<span class="n">n_l</span> <span class="o">=</span> <span class="m">51</span> <span class="o">+</span> <span class="m">992</span>
<span class="n">conf.level</span> <span class="o">=</span> <span class="m">0.95</span>
<span class="n">crit.val</span> <span class="o">=</span> <span class="nf">qnorm</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">conf.level</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="n">crit.val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
1.95996398454005
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># standard error</span>
<span class="n">se.hat</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">pi_h</span> <span class="o">*</span> <span class="p">(</span><span class="m">1</span> <span class="o">-</span> <span class="n">pi_h</span><span class="p">)</span><span class="o">/</span><span class="n">n_h</span> <span class="o">+</span> <span class="n">pi_l</span> <span class="o">*</span> <span class="p">(</span><span class="m">1</span> <span class="o">-</span> <span class="n">pi_l</span><span class="p">)</span><span class="o">/</span><span class="n">n_l</span><span class="p">)</span>
<span class="n">se.hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.0217710596635901
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># 95% CI</span>
<span class="nf">c</span><span class="p">((</span><span class="n">pi_h</span><span class="o">-</span><span class="n">pi_l</span><span class="p">)</span><span class="o">-</span><span class="n">crit.val</span><span class="o">*</span><span class="n">se.hat</span><span class="p">,</span> <span class="p">(</span><span class="n">pi_h</span><span class="o">-</span><span class="n">pi_l</span><span class="p">)</span><span class="o">+</span><span class="n">crit.val</span><span class="o">*</span><span class="n">se.hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>0.0517887391972153</li>
	<li>0.137129724889034</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># easier way for bonimial sampling</span>
<span class="nf">prop.test</span><span class="p">(</span><span class="n">cvd</span><span class="p">,</span> <span class="n">correct</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	2-sample test for equality of proportions without continuity
	correction

data:  cvd
X-squared = 31.082, df = 1, p-value = 2.474e-08
alternative hypothesis: two.sided
95 percent confidence interval:
 0.05178874 0.13712972
sample estimates:
    prop 1     prop 2 
0.14335664 0.04889741 
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># or chisq test</span>
<span class="nf">chisq.test</span><span class="p">(</span><span class="n">cvd</span><span class="p">,</span> <span class="n">correct</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	Pearson&#39;s Chi-squared test

data:  cvd
X-squared = 31.082, df = 1, p-value = 2.474e-08
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area border">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Don&#39;t use this, provide different result from the manual way</span>
<span class="nf">prop.test</span><span class="p">(</span><span class="n">cvd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	2-sample test for equality of proportions with continuity correction

data:  cvd
X-squared = 29.633, df = 1, p-value = 5.221e-08
alternative hypothesis: two.sided
95 percent confidence interval:
 0.0495611 0.1393574
sample estimates:
    prop 1     prop 2 
0.14335664 0.04889741 
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The CI does not include 0.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Contingency-Table">Contingency Table<a class="anchor-link" href="#Contingency-Table">&#182;</a></h4><p>Have a row factor with $I$ levels and a column factor with $J$ levels</p>
<p>Then, define $P(C=i,R=j)=\pi_{ij}, P(C=i)=\pi_{i\cdot}, P(R=j)=\pi_{\cdot j}$</p>
<p>Hypothesis: $H_0: \pi_{ij} = \pi_{i\cdot}\pi_{\cdot j}, H_a: \pi_{ij} \neq\pi_{i\cdot}\pi_{\cdot j}$
null: there is no relationship between the two factors</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each cell, estimated expected cell count $\hat\mu_{ij} = n\hat\pi_i\hat\pi_j = y_{i\cdot}y_{\cdot j}/n$</p>
<p>Test statistic: $X^2 = \sum_{j=1}^J\sum_{i=1}^I \frac{(y_{ij}-\hat\mu_{ij})^2}{\hat\mu_{ij}}\sim \chi^2_{(I-1)(J-1)} $</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If $var(y)=E(y)=\mu\Rightarrow y\sim Poisson(\mu)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this case, test statistic: $ 31.08\sim \chi^2_{(2-1)(2-1)}$, p-value $&lt;0.0001$</p>
<p>Strong evidence that the two factors are not independent, CVD status depends on cholesterol level.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When $I=J=2$, the chi-square test of independence is equivalent to comparing two proportions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Formal approach</strong><br>
Let $Y_{ij}$ be r.v. representing the number of observations in cell $(i,j)$.</p>
<p>Observe $y_{ij}$ be observed cell counts</p>
<p>Then multinomial $$P(Y=y)=\frac{n!\pi_{11}^{y_{11}}\pi_{12}^{y_{12}}\pi_{21}^{y_{21}}\pi_{22}^{y_{22}}} {y_{11}!y_{12}!y_{21}!y_{22}!}\sim Multinomial(n,\pi_{11},\pi_{12},\pi_{21},\pi_{22})$$</p>
<p>Log-likelihood is 
$$\log\mathcal{L}=\sum_{j=1}^2\sum_{i=1}^2 y_{ij}\log\pi_{ij}+\log{n\choose y_{11}y_{12}y_{21}y_{22}}$$</p>
<p>Maximize $\log\mathcal{L}$ w.r.t. $\pi$'s and $\sum\sum\pi_{ij}=1$, then $\hat\pi_{ij}=y_{ij}/n$</p>
<p>Under $H_0: \pi_{ij}=\pi_{i\cdot}\pi_{\cdot j}$, can substitute $\pi_{ij}$ and maximize the column and row $\pi$'s.</p>
$$G^2 = -2\log(\mathcal{L}_R/\mathcal{L}_F)\sim\chi^2_{(I-1)(J-1)}$$<p>To obtain the d.f. 
df(Unrestrcited / FULL)-df(Independence/REDUCED)<br>
=#parameters in FULL($\pi_{ij}$) - #parameters in REDUCED($\pi_{i\cdot},\pi_{\cdot j}$)<br>
= $IJ-1-(I+J-2)$<br>
$-1$ because constraint $\sum\sum\pi_{ij}=1$<br>
$-2$ because constraint $\sum\pi_{i\cdot}=1,\sum\pi_{\cdot j}=1$</p>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</body>

 


</html>
