<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>TFN model - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/index/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">TFN model</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Transfer-Function-Noise-model">Transfer Function Noise model<a class="anchor-link" href="#Transfer-Function-Noise-model">&#182;</a></h4><p>Consider the model that 
$X_t = f(X_{t-1}, X_{t-2}, ... , Z_t, Z_{t-1},...)$, $X_t$ is a linear combination of past observations and an external variable.</p>
<p>A TFN model is a time series regression that predict values of a dependent variable based on both the current and lagged values of one or more explanatory variables.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Procedure-of-building-the-single-input-TFN-model">Procedure of building the single input TFN model<a class="anchor-link" href="#Procedure-of-building-the-single-input-TFN-model">&#182;</a></h4><ol>
<li>Preliminary identification of the impulse response coefficients $v_i$ (prewhitening)</li>
<li>Specification of the noise term $n_t$</li>
<li>Specification of the transfer function using a rational polynomial in B if necessary</li>
<li>Estimation of the TFN specified </li>
<li>Model diagnostic checks</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Rational distributed lag model</strong>
$v(B)$ can be approximated by a ratio of polynomials<br>
$$v(B)=\frac{\sum_0^r\delta B^i}{1-\sum_1^s\theta_i B^i} = \delta(B)/\theta(B)$$
and then, $y_t = \delta(B)x_t / \theta(B) + n_t$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ARMAX">ARMAX<a class="anchor-link" href="#ARMAX">&#182;</a></h4><p>$y_t = v(B)x_t + n_t = v_0 x_t + v_1 x_{t-1}+v_2 x_{t-2}+...+n_t$<br>
where $v(B) = \sum^\infty v_j B^j$, and $x_t,n_t$ are independent.</p>
<p>The coefficient $v_0, v_1,...$ are referred as the impulse response function of the system.</p>
<p>To make such equation to be meaningful, $\sum^\infty |v_j| = g&lt;\infty$, which the system is stable and $g$ is called the stead-state gain. $g$ represents the impact on $Y$ when $X_{t-j}$ are held constant over time.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Properties</strong><br>
$x_t \sim ARMA(p,q)$, $v_i = \phi^i (1-\phi)$, $y_t = \sum^\infty v_i x_{t-i}+a_t$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Pre-whitening">Pre-whitening<a class="anchor-link" href="#Pre-whitening">&#182;</a></h4><p>Consider $x\sim $ARMA, i.e. $\Phi_x(B)x_t = \Theta_x(B)a_t$<br>
Apply $\Phi_x(B)/\Theta_x(B)$ on TFN model<br>
$\frac{\Phi_x(B)}{\Theta_x(B)}y_t = v(B)\frac{\Phi_x(B)}{\Theta_x(B)} x_t + \frac{\Phi_x(B)}{\Theta_x(B)}\epsilon_t$<br>
Let $\tau_t = \frac{\Phi_x(B)}{\Theta_x(B)} y_t, n_t = \frac{\Phi_x(B)}{\Theta_x(B)} \epsilon_t$, we get<br>
$\tau_t = v(B)a_t + n_t$ and $n_t$ is independent of $a_t$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get $\gamma_{a\tau}(0)$, multiply both sides by $a_t$ and take the expectations. 
$\gamma_{a\tau}(0)=E(a_t\tau_t) = E(a_tv(B)a_t) + E(a_tn_t)$<br>
$=E((v_0a_t + v_1e_{t-1}+...+v_ma_{t-m})a_t)$<br>
$=E(v_0a_ta_t)=v_o\gamma_a(0) = v_0\sigma^2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get $\gamma_{a\tau}(1)$, multiply both sides by $a_{t-1}$<br>
$\gamma_{a\tau}(1)=E(a_{t-1}\tau_t) =E(a_{t-1}v(B)a_t) + E(a_{t-1}n_t)$<br>
$=E(a_{t-1}(v_0a_t + v_1 a_{t-1} + v_2 a_{t-2}+...+v_m a_{t-m}))$<br>
$= E(a_{t-1}v_1 a_{t-1})=v_1\gamma_a(0) = v_1\sigma^2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Therefore, $\gamma_{a\tau(k)} = v_k\sigma^2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since $\rho_{a\tau}(k) = \gamma_{a\tau}(k) / \sigma_a\sigma_\tau$<br>
$\rho_{a\tau}(k) = \frac{v_k \sigma_a^2}{\sigma_a\sigma_\tau} = \frac{v_k \sigma_a}{\sigma_\tau}$<br>
and $v_k = \rho_{a\tau}(k)\frac{\sigma_\tau}{\sigma_a}\propto \rho_{a\tau}(k)$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Box-Tiao-Transformation">Box-Tiao Transformation<a class="anchor-link" href="#Box-Tiao-Transformation">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, since $n_t\sim$ ARMA, i.e. $\Phi_n(B)n_t = \Theta_n(B)a_t$<br>
Which $\frac{\Phi_n(B)}{\Theta_n(B)}n_t = a_t$<br>
Then, apply $\frac{\Phi_n(B)}{\Theta_n(B)}$ to both sides of the equation. 
$$\frac{\Phi_n(B)}{\Theta_n(B)} y_t = v(B) \frac{\Phi_n(B)}{\Theta_n(B)} x_t + $\frac{\Phi_n(B)}{\Theta_n(B)} n_t$$
$$\tilde y_t = v(B)\tilde x_t + a_t$$
is called the Box-Tiao Transformation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Steps-of-The-Estimation-Procedure">Steps of The Estimation Procedure<a class="anchor-link" href="#Steps-of-The-Estimation-Procedure">&#182;</a></h4><p>The steps of the estimation procedures</p>
<ol>
<li>Run the OLS regression on $y_t = \sum_{j=1}^s v_j x_{t-j} + e_t$ to collect the residuals $\{\hat e_t\}$</li>
<li>Identify an ARMA model for $\hat e_t$ </li>
<li>Apply Box-Tiao transformation to filter $y_t, x_t$</li>
<li>Run regression on the transformed equation</li>
<li>check the correlation of regression residuals </li>
</ol>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $("table").addClass("table table-lined")
  </script>
</body>

 


</html>
