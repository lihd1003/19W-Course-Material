<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>The Camera - Notes Portal</title>

<link rel="icon" type="image/gif" href="https://lihd1003.github.io/assets/images/logo.png">
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/vendor.css" />
<link rel="stylesheet" href="https://lihd1003.github.io/assets/css/style.css" />
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/98fa07784c.js"></script>



<style type="text/css">
/* Overrides of notebook CSS for static HTML export */

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="https://lihd1003.github.io/UofT-Course-Material-Repo/table_of_content/custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
	<!-- header -->
   <header class="header-sticky header-dark">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="./index.html">
          <img class="navbar-logo navbar-logo-light" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
          <img class="navbar-logo navbar-logo-dark" src="https://lihd1003.github.io/assets/images/logo.png" alt="Logo">
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav align-items-center mr-auto">
          </ul>

          <ul class="navbar-nav align-items-center mr-0">
            <li class="nav-item">
              <a href="https://github.com/lihd1003" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-github mr-2"></i>GitHub
              </a>
            </li>
            <li class="nav-item">
              <a href="https://github.com/lihd1003/UofT-Course-Material-Repo" class="nav-link waves-effect waves-light" target="_blank">
                <i class="icon-star mr-2"></i>Star the Repo
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

<section class="hero hero-with-header text-white" data-top-top="transform: translateY(0px);" data-top-bottom="transform: translateY(250px);">
    <div class="image image-overlay" style="background-image:url(https://lihd1003.github.io/assets/images/black.jpg)"></div>
    <div class="container">
      <div class="row align-items-center">
        <div class="col text-shadow">

          <h1 class="mb-0">The Camera</h1>
        </div>
      </div>
    </div>
 </section>
 <section class="bg-white sec" id="project">
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pinhole-and-lens">Pinhole and lens<a class="anchor-link" href="#Pinhole-and-lens">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Focus">Focus<a class="anchor-link" href="#Focus">&#182;</a></h4><p>The focal point $f = \lim_{d\rightarrow\infty} u$ where<br>
$f$ is the focal length<br>
$d$ is the distance of the object from the lens<br>
$u$ is the distance of the image plane</p>
<p><strong>Thin lens law</strong> $f^{-1} = u^{-1} + d^{-1}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Depth-of-Field-wiki">Depth of Field <a href="https://en.wikipedia.org/wiki/Depth_of_field" target="_blank">wiki</a><a class="anchor-link" href="#Depth-of-Field-wiki">&#182;</a></h4><p>Range of distances where blur &lt; 1 sensor pixel.</p>
<p>$DOF \approx \frac{2u^2 NC}{f^2}$ where<br>
$C=$ given circle of confusion (pixel size)<br>
$f=$ focal length<br>
$N=$ f-stop<br>
$u=$ subject distance</p>
<p>Typically, callphone camera has wider-angle lens (short focal length), hence larger DoF. Therefore, it can capture all objects in different distance, and then fake the blur by algorithm</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Camera-controls">Camera controls<a class="anchor-link" href="#Camera-controls">&#182;</a></h3><p><strong>Aperture</strong> expressed as $D:=f/N$,the relative size of the area in which light is collected through the lens</p>
<p><strong>Shutter speed</strong> $\Delta t$, the duration of the exposure, often expressed as fractions of a second</p>
<h4 id="DoF-vs.-Aperture-and-Shutter-Speed">DoF vs. Aperture and Shutter Speed<a class="anchor-link" href="#DoF-vs.-Aperture-and-Shutter-Speed">&#182;</a></h4><p>The capture photons $\propto D^2 \Delta t$<br>
The number of photons captured will influence the exposure.</p>
<p>Also, consider DoF,<br>
$D = f/N\uparrow \Rightarrow DOF\downarrow$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ISO-film-speed">ISO film speed<a class="anchor-link" href="#ISO-film-speed">&#182;</a></h4><p>The sensitivity of film/sensor to light</p>
<p>Given exposure ($D^2\Delta t$) being constant, $ISO\uparrow\Rightarrow brightness\uparrow$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Color-image">Color image<a class="anchor-link" href="#Color-image">&#182;</a></h3><p>All sensor pixels have same response curve, i.e. monochromatic and can only accepts intensity. To obtain a colored image, typically each pixel will be made to be sensitive or one of RGB by filters, typically 25% R, 25% B, 50% G. And full-color images can be obtained by <strong>demosaicing</strong> each pixel with missing RGB.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Steps-of--image-formation">Steps of  image formation<a class="anchor-link" href="#Steps-of--image-formation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Photons-to-Digital-Numbers-(Linear-operations)">Photons to Digital Numbers (Linear operations)<a class="anchor-link" href="#Photons-to-Digital-Numbers-(Linear-operations)">&#182;</a></h4><ol>
<li><p><strong>radiant power from scene</strong> Arriving photons causes photo-electrons and the charge accumulates are more photons hits the photo-diode</p>
<ul>
<li>The radiant power $\Phi = \int_\bar q\int_\lambda H(\bar q, \lambda) S(\bar q) Q(\lambda)d\bar qd\lambda$ where<br>
$\bar q = $ pixel footprint<br>
$\lambda = $ wave length<br>
$H=$ incidcent spectral irrandiance (the flux that can be received per/at that surface per/at that wavelength)<br>
$S=$ spatial response (the sensitivity of the sensor to radiation from different directions)<br>
$Q=$ quantum device efficiency (electrons that can be collected per incident photon at given wavelength)</li>
</ul>
</li>
</ol>
<ol>
<li><strong>Exposure</strong> After exposure time, amplifier converts charge to measurable voltage  <ul>
<li>With the exposure time $\Delta t$, now the total illuminance/irradiance is $\Phi\Delta t$</li>
<li>At same time, <strong>black level</strong>, a non-photoelextric current from photo diode, $I_0$ is added, to make the least black level. The result is $\Phi \Delta t + I_0$ </li>
</ul>
</li>
</ol>
<ol>
<li><p><strong>Sensor saturation</strong> The current cannot exceed <strong>saturation current</strong> a set-maximum non-discarded current from photodiode</p>
<ul>
<li>$I_m = $ saturation current, adjust the voltage by $\min(\Phi\Delta t + I_0, I_m)$  </li>
</ul>
</li>
<li><p><strong>Gain factor</strong> Apply an amplifier gain $g$, which is controlled by ISO (the larger $g$ the darker the darker)</p>
<ul>
<li>the result will be $\frac{\min(\Phi\Delta t + I_0, I_m)}{g}$  </li>
<li>Since digital numbers is discrete, apply a flooring function $\lfloor\frac{\min(\Phi\Delta t + I_0, I_m)}{g}\rfloor$  </li>
</ul>
</li>
</ol>
<p>Therefore, $$DN = \lfloor\frac{\min(\Phi\Delta t + I_0, I_m)}{g}\rfloor$$
And for the whole process, the relationship is linear</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Gamma-correction-(camera-response-function)">Gamma correction (camera response function)<a class="anchor-link" href="#Gamma-correction-(camera-response-function)">&#182;</a></h4><p>Since human visual system doesn't have a linear response to light, DNs are passed through a gamma function to compensate, such function is $f(DN) := \beta(DN)^{1/\gamma}$ where $\beta, \gamma$ are constants that varies among different manufactures.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Image-Noise">Image Noise<a class="anchor-link" href="#Image-Noise">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Defocus Blur</strong><br>
when the scene points of interest are "out of focus" and not within the DoF</p>
<p><strong>Motion Blur</strong><br>
Camera moves significantly during exposure time<br>
More like with long exposures and long focal length (zooming in)</p>
<p><strong>Pixel noise</strong><br>
Incorrect exposure, not enough photons reaching sensor<br>
High ISO (gain) causes noise</p>
<p><strong>Rolling shutter</strong> <a href="https://en.wikipedia.org/wiki/Rolling_shutter">wiki</a><br>
When captured by scanning across the scene rapidly</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Sources-of-Noise">Sources of Noise<a class="anchor-link" href="#Sources-of-Noise">&#182;</a></h4><p><em>radiant power from scene</em></p>
<p><strong>Dark Current Noise</strong></p>
<ul>
<li>free electrons due to thermal energy, depends on temperature  </li>
<li>$\sim Poisson(\lambda = D\Delta t), D:=$thermal electron rate $(e^-/sec)$</li>
</ul>
<p><em>Exposure</em></p>
<p><strong>Photon (Shot) Noise</strong></p>
<ul>
<li>$\sim Poisson(\lambda = \Phi\Delta t )$<br>
$P_\lambda(\text{k events in }\Delta t) = \frac{\lambda ^k e^{-\lambda}}{k!}$<br>
i.e. $P(\text{#received photons}=k)= \frac{\Phi\Delta t ^k e^{-\Phi\Delta t}}{k!}$</li>
<li>Largest source of noise for high exposures</li>
<li>For large $\Phi\Delta t$, by LLN, we can approximate by $Poisson(\lambda)\approx N(\lambda, \sqrt \lambda)$</li>
</ul>
<p><em>Sensor saturation</em></p>
<p><strong>Readout Noise</strong></p>
<ul>
<li>$\sim N(0, \sigma_r)$, $\sigma_r$ depends on characteristics of electronics</li>
</ul>
<p><em>Gain factor</em></p>
<p><strong>Amplifier, ADC, and Quantization Noise</strong></p>
<ul>
<li>$\sim N(0, \sigma_{ADC})$  </li>
<li>The amplifier noise is dependent on $g$, i.e. gain or ISO. </li>
<li>Largest source of noise for low exposures</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Put-all-Noises-Together">Put all Noises Together<a class="anchor-link" href="#Put-all-Noises-Together">&#182;</a></h4><p>Since all four types of noise are independent of each other,</p>
$$\begin{align}
E(e^-) &amp;=&amp;\text{Black level} + &amp;\text{dark current} + &amp;\text{photon noise}\\
&amp;= \min\{&amp;I_0 + &amp;D\Delta t + &amp;\Phi\Delta t, I_m\}\\ 
\end{align}$$$$\begin{align}
var(e^-) &amp;= \text{dark current} &amp;+ \text{photon noise} &amp;+ \text{black level} &amp;+ \text{readout noise} &amp;+ \text{ADC noise}\\
var(e^-) &amp;= D\Delta t &amp;+ \phi\Delta t &amp;+ I_0 &amp;+ \sigma_r^2 &amp;+ \sigma^2_{ADC} g^2
\end{align}$$<p>Hence<br>
$E(DN) = \min\{\frac{I_0 + D\Delta t + \Phi\Delta t}{g}, \frac{I_m}{g}\}$<br>
$var(DN) = \frac{D\Delta t + \phi\Delta t + I_0 + \sigma_r^2}{g^2} + \sigma^2_{ADC} g^2$</p>
<p><strong>Signal-to-noise ratio</strong> $SNR = 10\log_{10} \frac{E(DN)^2}{var(DN)}$</p>

</div>
</div>
</div>
    </div>
  </div>
</section>
  <script src="https://lihd1003.github.io/assets/js/vendor.js"></script>
  <script src="https://lihd1003.github.io/assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</body>

 


</html>
